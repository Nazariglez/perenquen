!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.PQ=t()}}(function(){var define,module,exports;return function t(e,r,i){function s(o,a){if(!r[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(n)return n(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[o]={exports:{}};e[o][0].call(u.exports,function(t){var r=e[o][1][t];return s(r?r:t)},u,u.exports,t,e,r,i)}return r[o].exports}for(var n="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(t,e){var r=t("./core/const"),i={Class:t("./core/Class"),utils:t("./core/utils"),Game:t("./core/Game"),SceneManager:t("./core/SceneManager"),Scene:t("./display/Scene"),Graphics:t("./display/Graphics")};for(var s in r)i[s]=r[s];e.exports=t("./core/inherits")(i)},{"./core/Class":62,"./core/Game":63,"./core/SceneManager":64,"./core/const":65,"./core/inherits":66,"./core/utils":68,"./display/Graphics":69,"./display/Scene":70}],2:[function(t,e){e.exports={name:"pixi.js",version:"3.0.0-rc2",description:"Pixi.js is a fast lightweight 2D library that works across all devices.",author:"Mat Groves",contributors:["Chad Engler <chad@pantherdev.com>","Richard Davey <rdavey@gmail.com>"],main:"./src/index.js",homepage:"http://goodboydigital.com/",bugs:"https://github.com/GoodBoyDigital/pixi.js/issues",license:"MIT",repository:{type:"git",url:"https://github.com/GoodBoyDigital/pixi.js.git"},scripts:{test:"gulp test",docs:"./node_modules/.bin/jsdoc -c ./gulp/util/jsdoc.conf.json"},devDependencies:{browserify:"^8.0.2",chai:"^1.10.0",del:"^1.1.0",exorcist:"^0.1.6",gulp:"^3.8.10","gulp-cached":"^1.0.1","gulp-concat":"^2.5.2","gulp-debug":"^2.0.0","gulp-jsdoc":"^0.1.4","gulp-jshint":"^1.9.0","gulp-plumber":"^0.6.6","gulp-rename":"^1.2.0","gulp-uglify":"^1.0.2","gulp-util":"^3.0.1","ink-docstrap":"^0.5.2",jsdoc:"^3.3.0-alpha13","jshint-summary":"^0.4.0",karma:"^0.12.28","karma-firefox-launcher":"^0.1.0","karma-mocha":"^0.1.10","karma-spec-reporter":"^0.0.16",minimist:"^1.1.0",mocha:"^2.1.0","require-dir":"^0.1.0","run-sequence":"^1.0.2","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.0.0",watchify:"^2.2.1"},dependencies:{async:"^0.9.0","resource-loader":"^1.2.2",brfs:"^1.2.0"},browserify:{transform:["brfs"]}}},{}],3:[function(t,e){e.exports={VERSION:t("../../package.json").version,RENDERER_TYPE:{UNKNOWN:0,WEBGL:1,CANVAS:2},BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},RETINA_PREFIX:/@(.+)x/,RESOLUTION:1,FILTER_RESOLUTION:1,DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1},SHAPES:{POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},SPRITE_BATCH_SIZE:2e3}},{"../../package.json":2}],4:[function(t,e){function r(){s.call(this),this.children=[]}var i=t("../math"),s=t("./DisplayObject"),n=t("../textures/RenderTexture"),o=new i.Matrix;r.prototype=Object.create(s.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{width:{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}},height:{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}}),r.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)},r.prototype.addChildAt=function(t,e){if(t===this)return t;if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},r.prototype.swapChildren=function(t,e){if(t!==e){var r=this.getChildIndex(t),i=this.getChildIndex(e);if(0>r||0>i)throw new Error("swapChildren: Both the supplied DisplayObjects must be children of the caller.");this.children[r]=e,this.children[i]=t}},r.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},r.prototype.setChildIndex=function(t,e){if(0>e||e>=this.children.length)throw new Error("The supplied index is out of bounds");var r=this.getChildIndex(t);this.children.splice(r,1),this.children.splice(e,0,t)},r.prototype.getChildAt=function(t){if(0>t||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject is not a child of the caller");return this.children[t]},r.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(-1!==e)return this.removeChildAt(e)},r.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,this.children.splice(t,1),e},r.prototype.removeChildren=function(t,e){var r=t||0,i="number"==typeof e?e:this.children.length,s=i-r;if(s>0&&i>=s){for(var n=this.children.splice(r,s),o=0;o<n.length;++o)n[o].parent=null;return n}if(0===s&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},r.prototype.generateTexture=function(t,e,r){var i=this.getLocalBounds(),s=new n(t,0|i.width,0|i.height,t,r,e);return o.tx=-i.x,o.ty=-i.y,s.render(this,o),s},r.prototype.updateTransform=function(){if(this.visible){this.displayObjectUpdateTransform();for(var t=0,e=this.children.length;e>t;++t)this.children[t].updateTransform()}},r.prototype.containerUpdateTransform=r.prototype.updateTransform,r.prototype.getBounds=function(){if(!this._currentBounds){if(0===this.children.length)return i.Rectangle.EMPTY;for(var t,e,r,s=1/0,n=1/0,o=-1/0,a=-1/0,h=!1,l=0,u=this.children.length;u>l;++l){var c=this.children[l];c.visible&&(h=!0,t=this.children[l].getBounds(),s=s<t.x?s:t.x,n=n<t.y?n:t.y,e=t.width+t.x,r=t.height+t.y,o=o>e?o:e,a=a>r?a:r)}if(!h)return i.Rectangle.EMPTY;var d=this._bounds;d.x=s,d.y=n,d.width=o-s,d.height=a-n,this._currentBounds=d}return this._currentBounds},r.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=i.Matrix.IDENTITY;for(var e=0,r=this.children.length;r>e;++e)this.children[e].updateTransform();return this.worldTransform=t,this._currentBounds=null,this.getBounds()},r.prototype.renderWebGL=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var e,r;if(this._mask||this._filters){for(t.currentRenderer.flush(),this._filters&&t.filterManager.pushFilter(this,this._filters),this._mask&&t.maskManager.pushMask(this,this._mask),t.currentRenderer.start(),this._renderWebGL(t),e=0,r=this.children.length;r>e;e++)this.children[e].renderWebGL(t);t.currentRenderer.flush(),this._mask&&t.maskManager.popMask(this,this._mask),this._filters&&t.filterManager.popFilter(),t.currentRenderer.start()}else for(this._renderWebGL(t),e=0,r=this.children.length;r>e;++e)this.children[e].renderWebGL(t)}},r.prototype._renderWebGL=function(){},r.prototype._renderCanvas=function(){},r.prototype.renderCanvas=function(t){if(this.visible&&!(this.alpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask,t),this._renderCanvas(t);for(var e=0,r=this.children.length;r>e;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},r.prototype.destroy=function(t){if(s.prototype.destroy.call(this),t)for(var e=0,r=this.children.length;r>e;++e)this.children[e].destroy();this.removeChildren(),this.children=null}},{"../math":13,"../textures/RenderTexture":50,"./DisplayObject":5}],5:[function(t,e){function r(){this.position=new i.Point,this.scale=new i.Point(1,1),this.pivot=new i.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this.worldTransform=new i.Matrix,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new i.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cachedObject=null}var i=t("../math"),s=t("../utils"),n=t("../textures/RenderTexture"),o=new i.Matrix;r.prototype.constructor=r,s.eventTarget.mixin(r.prototype),e.exports=r,Object.defineProperties(r.prototype,{x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},worldVisible:{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}},mask:{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.renderable=!0),this._mask=t,this._mask&&(this._mask.renderable=!1)}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}}),r.prototype.updateTransform=function(){var t,e,r,s,n,o,a=this.parent.worldTransform,h=this.worldTransform;this.rotation%i.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),t=this._cr*this.scale.x,e=this._sr*this.scale.x,r=-this._sr*this.scale.y,s=this._cr*this.scale.y,n=this.position.x,o=this.position.y,(this.pivot.x||this.pivot.y)&&(n-=this.pivot.x*t+this.pivot.y*r,o-=this.pivot.x*e+this.pivot.y*s),h.a=t*a.a+e*a.c,h.b=t*a.b+e*a.d,h.c=r*a.a+s*a.c,h.d=r*a.b+s*a.d,h.tx=n*a.a+o*a.c+a.tx,h.ty=n*a.b+o*a.d+a.ty):(t=this.scale.x,s=this.scale.y,n=this.position.x-this.pivot.x*t,o=this.position.y-this.pivot.y*s,h.a=t*a.a,h.b=t*a.b,h.c=s*a.c,h.d=s*a.d,h.tx=n*a.a+o*a.c+a.tx,h.ty=n*a.b+o*a.d+a.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null},r.prototype.displayObjectUpdateTransform=r.prototype.updateTransform,r.prototype.getBounds=function(){return i.Rectangle.EMPTY},r.prototype.getLocalBounds=function(){return this.getBounds(i.Matrix.IDENTITY)},r.prototype.toGlobal=function(t){return this.displayObjectUpdateTransform(),this.worldTransform.apply(t)},r.prototype.toLocal=function(t,e){return e&&(t=e.toGlobal(t)),this.displayObjectUpdateTransform(),this.worldTransform.applyInverse(t)},r.prototype.renderWebGL=function(){},r.prototype.renderCanvas=function(){},r.prototype.generateTexture=function(t,e,r){var i=this.getLocalBounds(),s=new n(t,0|i.width,0|i.height,t,r,e);return o.tx=-i.x,o.ty=-i.y,s.render(this,o),s},r.prototype.destroy=function(){this.position=null,this.scale=null,this.pivot=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.worldTransform=null,this.filterArea=null,this.listeners=null}},{"../math":13,"../textures/RenderTexture":50,"../utils":57}],6:[function(t,e){function r(){i.call(this),this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this._prevTint=16777215,this.blendMode=u.BLEND_MODES.NORMAL,this.currentPath=null,this._webGL={},this.isMask=!1,this.boundsPadding=0,this._localBounds=new l.Rectangle(0,0,1,1),this.dirty=!0,this.glDirty=!1,this.cachedSpriteDirty=!1}var i=t("../display/Container"),s=t("../sprites/Sprite"),n=t("../textures/Texture"),o=t("../renderers/canvas/utils/CanvasBuffer"),a=t("../renderers/canvas/utils/CanvasGraphics"),h=t("./GraphicsData"),l=t("../math"),u=t("../const"),c=new l.Point;r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{}),r.prototype.clone=function(){var t=new r;t.renderable=this.renderable,t.fillAlpha=this.fillAlpha,t.lineWidth=this.lineWidth,t.lineColor=this.lineColor,t.tint=this.tint,t.blendMode=this.blendMode,t.isMask=this.isMask,t.boundsPadding=this.boundsPadding,t.dirty=this.dirty,t.glDirty=this.glDirty,t.cachedSpriteDirty=this.cachedSpriteDirty;for(var e=0;e<this.graphicsData.length;++e)t.graphicsData.push(this.graphicsData.clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t.updateLocalBounds(),t},r.prototype.lineStyle=function(t,e,r){return this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=arguments.length<3?1:r,this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new l.Polygon(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha)),this},r.prototype.moveTo=function(t,e){return this.drawShape(new l.Polygon([t,e])),this},r.prototype.lineTo=function(t,e){return this.currentPath.shape.points.push(t,e),this.dirty=!0,this},r.prototype.quadraticCurveTo=function(t,e,r,i){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s,n,o=20,a=this.currentPath.shape.points;0===a.length&&this.moveTo(0,0);for(var h=a[a.length-2],l=a[a.length-1],u=0,c=1;o>=c;++c)u=c/o,s=h+(t-h)*u,n=l+(e-l)*u,a.push(s+(t+(r-t)*u-s)*u,n+(e+(i-e)*u-n)*u);return this.dirty=!0,this},r.prototype.bezierCurveTo=function(t,e,r,i,s,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var o,a,h,l,u,c=20,d=this.currentPath.shape.points,p=d[d.length-2],f=d[d.length-1],g=0,y=1;c>=y;++y)g=y/c,o=1-g,a=o*o,h=a*o,l=g*g,u=l*g,d.push(h*p+3*a*g*t+3*o*l*r+u*s,h*f+3*a*g*e+3*o*l*i+u*n);return this.dirty=!0,this},r.prototype.arcTo=function(t,e,r,i,s){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var n=this.currentPath.shape.points,o=n[n.length-2],a=n[n.length-1],h=a-e,l=o-t,u=i-e,c=r-t,d=Math.abs(h*c-l*u);if(1e-8>d||0===s)(n[n.length-2]!==t||n[n.length-1]!==e)&&n.push(t,e);else{var p=h*h+l*l,f=u*u+c*c,g=h*u+l*c,y=s*Math.sqrt(p)/d,x=s*Math.sqrt(f)/d,v=y*g/p,m=x*g/f,E=y*c+x*l,b=y*u+x*h,_=l*(x+v),T=h*(x+v),R=c*(y+m),S=u*(y+m),A=Math.atan2(T-b,_-E),w=Math.atan2(S-b,R-E);this.arc(E+t,b+e,s,A,w,l*u>c*h)}return this.dirty=!0,this},r.prototype.arc=function(t,e,r,i,s,n){var o,a=t+Math.cos(i)*r,h=e+Math.sin(i)*r;if(this.currentPath?(o=this.currentPath.shape.points,0===o.length?o.push(a,h):(o[o.length-2]!==a||o[o.length-1]!==h)&&o.push(a,h)):(this.moveTo(a,h),o=this.currentPath.shape.points),i===s)return this;!n&&i>=s?s+=2*Math.PI:n&&s>=i&&(i+=2*Math.PI);var l=n?-1*(i-s):s-i,u=40*Math.ceil(Math.abs(l)/(2*Math.PI));if(0===l)return this;for(var c=l/(2*u),d=2*c,p=Math.cos(c),f=Math.sin(c),g=u-1,y=g%1/g,x=0;g>=x;x++){var v=x+y*x,m=c+i+d*v,E=Math.cos(m),b=-Math.sin(m);o.push((p*E+f*b)*r+t,(p*-b+f*E)*r+e)}return this.dirty=!0,this},r.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=void 0===e?1:e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},r.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},r.prototype.drawRect=function(t,e,r,i){return this.drawShape(new l.Rectangle(t,e,r,i)),this},r.prototype.drawRoundedRect=function(t,e,r,i,s){return this.drawShape(new l.RoundedRectangle(t,e,r,i,s)),this},r.prototype.drawCircle=function(t,e,r){return this.drawShape(new l.Circle(t,e,r)),this},r.prototype.drawEllipse=function(t,e,r,i){return this.drawShape(new l.Ellipse(t,e,r,i)),this},r.prototype.drawPolygon=function(t){return t instanceof Array||(t=Array.prototype.slice.call(arguments)),this.drawShape(new l.Polygon(t)),this},r.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},r.prototype.generateTexture=function(t,e){t=t||1;var r=this.getBounds(),i=new o(r.width*t,r.height*t),s=n.fromCanvas(i.canvas,e);return s.baseTexture.resolution=t,i.context.scale(t,t),i.context.translate(-r.x,-r.y),a.renderGraphics(this,i.context),s},r.prototype._renderWebGL=function(t){this.glDirty&&(this.dirty=!0,this.glDirty=!1),t.setObjectRenderer(t.plugins.graphics),t.plugins.graphics.render(this)},r.prototype._renderCanvas=function(t){if(this.isMask!==!0){if(this._prevTint!==this.tint&&(this.dirty=!0,this._prevTint=this.tint),this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=this.alpha,void s.prototype._renderCanvas.call(this._cachedSprite,t);var e=t.context,r=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=t.blendModes[t.currentBlendMode]);var i=t.resolution;e.setTransform(r.a*i,r.b*i,r.c*i,r.d*i,r.tx*i,r.ty*i),a.renderGraphics(this,e)}},r.prototype.getBounds=function(t){if(!this._currentBounds){if(!this.renderable)return l.Rectangle.EMPTY;this.dirty&&(this.updateLocalBounds(),this.glDirty=!0,this.cachedSpriteDirty=!0,this.dirty=!1);var e=this._localBounds,r=e.x,i=e.width+e.x,s=e.y,n=e.height+e.y,o=t||this.worldTransform,a=o.a,h=o.b,u=o.c,c=o.d,d=o.tx,p=o.ty,f=a*i+u*n+d,g=c*n+h*i+p,y=a*r+u*n+d,x=c*n+h*r+p,v=a*r+u*s+d,m=c*s+h*r+p,E=a*i+u*s+d,b=c*s+h*i+p,_=f,T=g,R=f,S=g;R=R>y?y:R,R=R>v?v:R,R=R>E?E:R,S=S>x?x:S,S=S>m?m:S,S=S>b?b:S,_=y>_?y:_,_=v>_?v:_,_=E>_?E:_,T=x>T?x:T,T=m>T?m:T,T=b>T?b:T,this._bounds.x=R,this._bounds.width=_-R,this._bounds.y=S,this._bounds.height=T-S,this._currentBounds=this._bounds}return this._currentBounds},r.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,c);for(var e=this.graphicsData,r=0;r<e.length;r++){var i=e[r];if(i.fill&&i.shape&&i.shape.contains(c.x,c.y))return!0}return!1},r.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,r=1/0,i=-1/0;if(this.graphicsData.length)for(var s,n,o,a,h,l,c=0;c<this.graphicsData.length;c++){var d=this.graphicsData[c],p=d.type,f=d.lineWidth;if(s=d.shape,p===u.SHAPES.RECT||p===u.SHAPES.RREC)o=s.x-f/2,a=s.y-f/2,h=s.width+f,l=s.height+f,t=t>o?o:t,e=o+h>e?o+h:e,r=r>a?a:r,i=a+l>i?a+l:i;else if(p===u.SHAPES.CIRC)o=s.x,a=s.y,h=s.radius+f/2,l=s.radius+f/2,t=t>o-h?o-h:t,e=o+h>e?o+h:e,r=r>a-l?a-l:r,i=a+l>i?a+l:i;else if(p===u.SHAPES.ELIP)o=s.x,a=s.y,h=s.width+f/2,l=s.height+f/2,t=t>o-h?o-h:t,e=o+h>e?o+h:e,r=r>a-l?a-l:r,i=a+l>i?a+l:i;else{n=s.points;for(var g=0;g<n.length;g+=2)o=n[g],a=n[g+1],t=t>o-f?o-f:t,e=o+f>e?o+f:e,r=r>a-f?a-f:r,i=a+f>i?a+f:i}}else t=0,e=0,r=0,i=0;var y=this.boundsPadding;this._localBounds.x=t-y,this._localBounds.width=e-t+2*y,this._localBounds.y=r-y,this._localBounds.height=i-r+2*y},r.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new h(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(e),e.type===u.SHAPES.POLY&&(e.shape.closed=this.filling,this.currentPath=e),this.dirty=!0,e}},{"../const":3,"../display/Container":4,"../math":13,"../renderers/canvas/utils/CanvasBuffer":25,"../renderers/canvas/utils/CanvasGraphics":26,"../sprites/Sprite":47,"../textures/Texture":51,"./GraphicsData":7}],7:[function(t,e){function r(t,e,r,i,s,n,o){this.lineWidth=t,this.lineColor=e,this.lineAlpha=r,this._lineTint=e,this.fillColor=i,this.fillAlpha=s,this._fillTint=i,this.fill=n,this.shape=o,this.type=o.type}r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)}},{}],8:[function(t,e){function r(t){o.call(this,t),this.graphicsDataPool=[],this.primitiveShader=null,this.complexPrimitiveShader=null}var i=t("../../utils"),s=t("../../math"),n=t("../../const"),o=t("../../renderers/webgl/utils/ObjectRenderer"),a=t("../../renderers/webgl/WebGLRenderer"),h=t("./WebGLGraphicsData");r.prototype=Object.create(o.prototype),r.prototype.constructor=r,e.exports=r,a.registerPlugin("graphics",r),r.prototype.onContextChange=function(){},r.prototype.destroy=function(){o.prototype.destroy.call(this),this.graphicsDataPool=null},r.prototype.render=function(t){var e,r=this.renderer,s=r.gl,n=r.shaderManager.plugins.primitiveShader;t.dirty&&this.updateGraphics(t,s);var o=t._webGL[s.id];r.blendModeManager.setBlendMode(t.blendMode);for(var a=0;a<o.data.length;a++)1===o.data[a].mode?(e=o.data[a],r.stencilManager.pushStencil(t,e,r),s.drawElements(s.TRIANGLE_FAN,4,s.UNSIGNED_SHORT,2*(e.indices.length-4)),r.stencilManager.popStencil(t,e,r)):(e=o.data[a],n=r.shaderManager.primitiveShader,r.shaderManager.setShader(n),s.uniformMatrix3fv(n.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),s.uniformMatrix3fv(n.uniforms.projectionMatrix._location,!1,r.currentRenderTarget.projectionMatrix.toArray(!0)),s.uniform3fv(n.uniforms.tint._location,i.hex2rgb(t.tint)),s.uniform1f(n.uniforms.alpha._location,t.worldAlpha),s.bindBuffer(s.ARRAY_BUFFER,e.buffer),s.vertexAttribPointer(n.attributes.aVertexPosition,2,s.FLOAT,!1,24,0),s.vertexAttribPointer(n.attributes.aColor,4,s.FLOAT,!1,24,8),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.indexBuffer),s.drawElements(s.TRIANGLE_STRIP,e.indices.length,s.UNSIGNED_SHORT,0))},r.prototype.updateGraphics=function(t){var e=this.renderer.gl,r=t._webGL[e.id];r||(r=t._webGL[e.id]={lastIndex:0,data:[],gl:e}),t.dirty=!1;var i;if(t.clearDirty){for(t.clearDirty=!1,i=0;i<r.data.length;i++){var s=r.data[i];s.reset(),this.graphicsDataPool.push(s)}r.data=[],r.lastIndex=0}var o;for(i=r.lastIndex;i<t.graphicsData.length;i++){var a=t.graphicsData[i];if(a.type===n.SHAPES.POLY){if(a.points=a.shape.points.slice(),a.shape.closed&&(a.points[0]!==a.points[a.points.length-2]||a.points[1]!==a.points[a.points.length-1])&&a.points.push(a.points[0],a.points[1]),a.fill&&a.points.length>=6)if(a.points.length<12){o=this.switchMode(r,0);var h=this.buildPoly(a,o);h||(o=this.switchMode(r,1),this.buildComplexPoly(a,o))}else o=this.switchMode(r,1),this.buildComplexPoly(a,o);a.lineWidth>0&&(o=this.switchMode(r,0),this.buildLine(a,o))}else o=this.switchMode(r,0),a.type===n.SHAPES.RECT?this.buildRectangle(a,o):a.type===n.SHAPES.CIRC||a.type===n.SHAPES.ELIP?this.buildCircle(a,o):a.type===n.SHAPES.RREC&&this.buildRoundedRectangle(a,o);r.lastIndex++}for(i=0;i<r.data.length;i++)o=r.data[i],o.dirty&&o.upload()},r.prototype.switchMode=function(t,e){var r;return t.data.length?(r=t.data[t.data.length-1],(r.points.length>32e4||r.mode!==e||1===e)&&(r=this.graphicsDataPool.pop()||new h(t.gl),r.mode=e,t.data.push(r))):(r=this.graphicsDataPool.pop()||new h(t.gl),r.mode=e,t.data.push(r)),r.dirty=!0,r},r.prototype.buildRectangle=function(t,e){var r=t.shape,s=r.x,n=r.y,o=r.width,a=r.height;if(t.fill){var h=i.hex2rgb(t.fillColor),l=t.fillAlpha,u=h[0]*l,c=h[1]*l,d=h[2]*l,p=e.points,f=e.indices,g=p.length/6;p.push(s,n),p.push(u,c,d,l),p.push(s+o,n),p.push(u,c,d,l),p.push(s,n+a),p.push(u,c,d,l),p.push(s+o,n+a),p.push(u,c,d,l),f.push(g,g,g+1,g+2,g+3,g+3)}if(t.lineWidth){var y=t.points;t.points=[s,n,s+o,n,s+o,n+a,s,n+a,s,n],this.buildLine(t,e),t.points=y}},r.prototype.buildRoundedRectangle=function(t,e){var r=t.shape,s=r.x,n=r.y,o=r.width,a=r.height,h=r.radius,l=[];if(l.push(s,n+h),l=l.concat(this.quadraticBezierCurve(s,n+a-h,s,n+a,s+h,n+a)),l=l.concat(this.quadraticBezierCurve(s+o-h,n+a,s+o,n+a,s+o,n+a-h)),l=l.concat(this.quadraticBezierCurve(s+o,n+h,s+o,n,s+o-h,n)),l=l.concat(this.quadraticBezierCurve(s+h,n,s,n,s,n+h)),t.fill){var u=i.hex2rgb(t.fillColor),c=t.fillAlpha,d=u[0]*c,p=u[1]*c,f=u[2]*c,g=e.points,y=e.indices,x=g.length/6,v=i.PolyK.Triangulate(l),m=0;for(m=0;m<v.length;m+=3)y.push(v[m]+x),y.push(v[m]+x),y.push(v[m+1]+x),y.push(v[m+2]+x),y.push(v[m+2]+x);for(m=0;m<l.length;m++)g.push(l[m],l[++m],d,p,f,c)}if(t.lineWidth){var E=t.points;t.points=l,this.buildLine(t,e),t.points=E}},r.prototype.quadraticBezierCurve=function(t,e,r,i,s,n){function o(t,e,r){var i=e-t;return t+i*r}for(var a,h,l,u,c,d,p=20,f=[],g=0,y=0;p>=y;y++)g=y/p,a=o(t,r,g),h=o(e,i,g),l=o(r,s,g),u=o(i,n,g),c=o(a,l,g),d=o(h,u,g),f.push(c,d);return f},r.prototype.buildCircle=function(t,e){var r,s,o=t.shape,a=o.x,h=o.y;t.type===n.SHAPES.CIRC?(r=o.radius,s=o.radius):(r=o.width,s=o.height);var l=40,u=2*Math.PI/l,c=0;if(t.fill){var d=i.hex2rgb(t.fillColor),p=t.fillAlpha,f=d[0]*p,g=d[1]*p,y=d[2]*p,x=e.points,v=e.indices,m=x.length/6;for(v.push(m),c=0;l+1>c;c++)x.push(a,h,f,g,y,p),x.push(a+Math.sin(u*c)*r,h+Math.cos(u*c)*s,f,g,y,p),v.push(m++,m++);v.push(m-1)}if(t.lineWidth){var E=t.points;for(t.points=[],c=0;l+1>c;c++)t.points.push(a+Math.sin(u*c)*r,h+Math.cos(u*c)*s);this.buildLine(t,e),t.points=E}},r.prototype.buildLine=function(t,e){var r=0,n=t.points;if(0!==n.length){if(t.lineWidth%2)for(r=0;r<n.length;r++)n[r]+=.5;var o=new s.Point(n[0],n[1]),a=new s.Point(n[n.length-2],n[n.length-1]);if(o.x===a.x&&o.y===a.y){n=n.slice(),n.pop(),n.pop(),a=new s.Point(n[n.length-2],n[n.length-1]);var h=a.x+.5*(o.x-a.x),l=a.y+.5*(o.y-a.y);n.unshift(h,l),n.push(h,l)}var u,c,d,p,f,g,y,x,v,m,E,b,_,T,R,S,A,w,M,C,P,L,D,B=e.points,O=e.indices,F=n.length/2,N=n.length,I=B.length/6,U=t.lineWidth/2,k=i.hex2rgb(t.lineColor),G=t.lineAlpha,j=k[0]*G,z=k[1]*G,W=k[2]*G;for(d=n[0],p=n[1],f=n[2],g=n[3],v=-(p-g),m=d-f,D=Math.sqrt(v*v+m*m),v/=D,m/=D,v*=U,m*=U,B.push(d-v,p-m,j,z,W,G),B.push(d+v,p+m,j,z,W,G),r=1;F-1>r;r++)d=n[2*(r-1)],p=n[2*(r-1)+1],f=n[2*r],g=n[2*r+1],y=n[2*(r+1)],x=n[2*(r+1)+1],v=-(p-g),m=d-f,D=Math.sqrt(v*v+m*m),v/=D,m/=D,v*=U,m*=U,E=-(g-x),b=f-y,D=Math.sqrt(E*E+b*b),E/=D,b/=D,E*=U,b*=U,R=-m+p-(-m+g),S=-v+f-(-v+d),A=(-v+d)*(-m+g)-(-v+f)*(-m+p),w=-b+x-(-b+g),M=-E+f-(-E+y),C=(-E+y)*(-b+g)-(-E+f)*(-b+x),P=R*M-w*S,Math.abs(P)<.1?(P+=10.1,B.push(f-v,g-m,j,z,W,G),B.push(f+v,g+m,j,z,W,G)):(u=(S*C-M*A)/P,c=(w*A-R*C)/P,L=(u-f)*(u-f)+(c-g)+(c-g),L>19600?(_=v-E,T=m-b,D=Math.sqrt(_*_+T*T),_/=D,T/=D,_*=U,T*=U,B.push(f-_,g-T),B.push(j,z,W,G),B.push(f+_,g+T),B.push(j,z,W,G),B.push(f-_,g-T),B.push(j,z,W,G),N++):(B.push(u,c),B.push(j,z,W,G),B.push(f-(u-f),g-(c-g)),B.push(j,z,W,G)));for(d=n[2*(F-2)],p=n[2*(F-2)+1],f=n[2*(F-1)],g=n[2*(F-1)+1],v=-(p-g),m=d-f,D=Math.sqrt(v*v+m*m),v/=D,m/=D,v*=U,m*=U,B.push(f-v,g-m),B.push(j,z,W,G),B.push(f+v,g+m),B.push(j,z,W,G),O.push(I),r=0;N>r;r++)O.push(I++);O.push(I-1)}},r.prototype.buildComplexPoly=function(t,e){var r=t.points.slice();if(!(r.length<6)){var s=e.indices;e.points=r,e.alpha=t.fillAlpha,e.color=i.hex2rgb(t.fillColor);for(var n,o,a=1/0,h=-1/0,l=1/0,u=-1/0,c=0;c<r.length;c+=2)n=r[c],o=r[c+1],a=a>n?n:a,h=n>h?n:h,l=l>o?o:l,u=o>u?o:u;r.push(a,l,h,l,h,u,a,u);var d=r.length/2;for(c=0;d>c;c++)s.push(c)}},r.prototype.buildPoly=function(t,e){var r=t.points;if(!(r.length<6)){var s=e.points,n=e.indices,o=r.length/2,a=i.hex2rgb(t.fillColor),h=t.fillAlpha,l=a[0]*h,u=a[1]*h,c=a[2]*h,d=i.PolyK.Triangulate(r);if(!d)return!1;var p=s.length/6,f=0;for(f=0;f<d.length;f+=3)n.push(d[f]+p),n.push(d[f]+p),n.push(d[f+1]+p),n.push(d[f+2]+p),n.push(d[f+2]+p);for(f=0;o>f;f++)s.push(r[2*f],r[2*f+1],l,u,c,h);return!0}}},{"../../const":3,"../../math":13,"../../renderers/webgl/WebGLRenderer":29,"../../renderers/webgl/utils/ObjectRenderer":43,"../../utils":57,"./WebGLGraphicsData":9}],9:[function(t,e){function r(t){this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0}r.prototype.constructor=r,e.exports=r,r.prototype.reset=function(){this.points=[],this.indices=[]},r.prototype.upload=function(){var t=this.gl;this.glPoints=new Float32Array(this.points),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW),this.glIndices=new Uint16Array(this.indices),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndices,t.STATIC_DRAW),this.dirty=!1}},{}],10:[function(t,e){function r(){try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement("canvas"),e=t.getContext("webgl",o)||t.getContext("experimental-webgl",o);return!(!e||!e.getContextAttributes().stencil)}catch(r){return!1}}var i=e.exports={utils:t("./utils"),math:t("./math"),CONST:t("./const"),DisplayObject:t("./display/DisplayObject"),Container:t("./display/Container"),Stage:t("./display/Container"),DisplayObjectContainer:t("./display/Container"),Sprite:t("./sprites/Sprite"),ParticleContainer:t("./particles/ParticleContainer"),SpriteRenderer:t("./sprites/webgl/SpriteRenderer"),ParticleRenderer:t("./particles/webgl/ParticleRenderer"),Graphics:t("./graphics/Graphics"),GraphicsData:t("./graphics/GraphicsData"),GraphicsRenderer:t("./graphics/webgl/GraphicsRenderer"),Texture:t("./textures/Texture"),BaseTexture:t("./textures/BaseTexture"),RenderTexture:t("./textures/RenderTexture"),VideoBaseTexture:t("./textures/VideoBaseTexture"),CanvasRenderer:t("./renderers/canvas/CanvasRenderer"),CanvasGraphics:t("./renderers/canvas/utils/CanvasGraphics"),CanvasBuffer:t("./renderers/canvas/utils/CanvasBuffer"),WebGLRenderer:t("./renderers/webgl/WebGLRenderer"),ShaderManager:t("./renderers/webgl/managers/ShaderManager"),Shader:t("./renderers/webgl/shaders/Shader"),AbstractFilter:t("./renderers/webgl/filters/AbstractFilter"),autoDetectRenderer:function(t,e,s,n){return t=t||800,e=e||600,!n&&r()?new i.WebGLRenderer(t,e,s):new i.CanvasRenderer(t,e,s)}},s=t("./const");for(var n in s)i[n]=s[n];var o={stencil:!0}},{"./const":3,"./display/Container":4,"./display/DisplayObject":5,"./graphics/Graphics":6,"./graphics/GraphicsData":7,"./graphics/webgl/GraphicsRenderer":8,"./math":13,"./particles/ParticleContainer":19,"./particles/webgl/ParticleRenderer":21,"./renderers/canvas/CanvasRenderer":24,"./renderers/canvas/utils/CanvasBuffer":25,"./renderers/canvas/utils/CanvasGraphics":26,"./renderers/webgl/WebGLRenderer":29,"./renderers/webgl/filters/AbstractFilter":30,"./renderers/webgl/managers/ShaderManager":36,"./renderers/webgl/shaders/Shader":41,"./sprites/Sprite":47,"./sprites/webgl/SpriteRenderer":48,"./textures/BaseTexture":49,"./textures/RenderTexture":50,"./textures/Texture":51,"./textures/VideoBaseTexture":53,"./utils":57}],11:[function(t,e){function r(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var i=t("./Point");r.prototype.constructor=r,e.exports=r,r.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},r.prototype.toArray=function(t){this.array||(this.array=new Float32Array(9));var e=this.array;return t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0,e[8]=1),e},r.prototype.apply=function(t,e){e=e||new i;var r=t.x,s=t.y;return e.x=this.a*r+this.c*s+this.tx,e.y=this.b*r+this.d*s+this.ty,e},r.prototype.applyInverse=function(t,e){e=e||new i;var r=1/(this.a*this.d+this.c*-this.b),s=t.x,n=t.y;return e.x=this.d*r*s+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*n+-this.b*r*s+(-this.ty*this.a+this.tx*this.b)*r,e},r.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},r.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},r.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),i=this.a,s=this.c,n=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=s*e-this.d*r,this.d=s*r+this.d*e,this.tx=n*e-this.ty*r,this.ty=n*r+this.ty*e,this},r.prototype.append=function(t){var e=this.a,r=this.b,i=this.c,s=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*s,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*s,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*s+this.ty,this},r.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},r.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,i=this.d,s=this.tx,n=t*i-e*r;return this.a=i/n,this.b=-e/n,this.c=-r/n,this.d=t/n,this.tx=(r*this.ty-i*s)/n,this.ty=-(t*this.ty-e*s)/n,this},r.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this
},r.prototype.clone=function(){var t=new r;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r.prototype.copy=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r.IDENTITY=new r,r.TEMP_MATRIX=new r},{"./Point":12}],12:[function(t,e){function r(t,e){this.x=t||0,this.y=e||0}r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)}},{}],13:[function(t,e){e.exports={PI_2:2*Math.PI,RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180,Point:t("./Point"),Matrix:t("./Matrix"),Circle:t("./shapes/Circle"),Ellipse:t("./shapes/Ellipse"),Polygon:t("./shapes/Polygon"),Rectangle:t("./shapes/Rectangle"),RoundedRectangle:t("./shapes/RoundedRectangle")}},{"./Matrix":11,"./Point":12,"./shapes/Circle":14,"./shapes/Ellipse":15,"./shapes/Polygon":16,"./shapes/Rectangle":17,"./shapes/RoundedRectangle":18}],14:[function(t,e){function r(t,e,r){this.x=t||0,this.y=e||0,this.radius=r||0,this.type=s.SHAPES.CIRC}var i=t("./Rectangle"),s=t("../../const");r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.x,this.y,this.radius)},r.prototype.contains=function(t,e){if(this.radius<=0)return!1;var r=this.x-t,i=this.y-e,s=this.radius*this.radius;return r*=r,i*=i,s>=r+i},r.prototype.getBounds=function(){return new i(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}},{"../../const":3,"./Rectangle":17}],15:[function(t,e){function r(t,e,r,i){this.x=t||0,this.y=e||0,this.width=r||0,this.height=i||0,this.type=s.SHAPES.ELIP}var i=t("./Rectangle"),s=t("../../const");r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var r=(t-this.x)/this.width,i=(e-this.y)/this.height;return r*=r,i*=i,1>=r+i},r.prototype.getBounds=function(){return new i(this.x-this.width,this.y-this.height,this.width,this.height)}},{"../../const":3,"./Rectangle":17}],16:[function(t,e){function r(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),t[0]instanceof i){for(var e=[],r=0,n=t.length;n>r;r++)e.push(t[r].x,t[r].y);t=e}this.closed=!0,this.points=t,this.type=s.SHAPES.POLY}var i=t("../Point"),s=t("../../const");r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.points.slice())},r.prototype.contains=function(t,e){for(var r=!1,i=this.points.length/2,s=0,n=i-1;i>s;n=s++){var o=this.points[2*s],a=this.points[2*s+1],h=this.points[2*n],l=this.points[2*n+1],u=a>e!=l>e&&(h-o)*(e-a)/(l-a)+o>t;u&&(r=!r)}return r}},{"../../const":3,"../Point":12}],17:[function(t,e){function r(t,e,r,s){this.x=t||0,this.y=e||0,this.width=r||0,this.height=s||0,this.type=i.SHAPES.RECT}var i=t("../../const");r.prototype.constructor=r,e.exports=r,r.EMPTY=new r(0,0,0,0),r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height?!0:!1}},{"../../const":3}],18:[function(t,e){function r(t,e,r,s,n){this.x=t||0,this.y=e||0,this.width=r||0,this.height=s||0,this.radius=n||20,this.type=i.SHAPES.RREC}var i=t("../../const");r.prototype.constructor=r,e.exports=r,r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.radius)},r.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height?!0:!1}},{"../../const":3}],19:[function(t,e){function r(t,e){i.call(this),this._properties=e||[!1,!0,!1,!1,!1],this._size=t||15e3,this._buffers=null,this._updateStatic=!1,this.interactiveChildren=!1}var i=t("../display/Container");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},r.prototype.renderWebGL=function(t){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(t.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},r.prototype.addChildAt=function(t,e){if(t===this)return t;if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this._updateStatic=!0,t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},r.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,this.children.splice(t,1),this._updateStatic=!0,e},r.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var e=t.context,r=this.worldTransform,i=!0;e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var s=0;s<this.children.length;++s){var n=this.children[s];if(n.visible){var o=n.texture.frame;if(e.globalAlpha=this.worldAlpha*n.alpha,n.rotation%(2*Math.PI)===0)i&&(e.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),i=!1),e.drawImage(n.texture.baseTexture.source,o.x,o.y,o.width,o.height,n.anchor.x*-o.width*n.scale.x+n.position.x+.5|0,n.anchor.y*-o.height*n.scale.y+n.position.y+.5|0,o.width*n.scale.x,o.height*n.scale.y);else{i||(i=!0),n.displayObjectUpdateTransform();var a=n.worldTransform;t.roundPixels?e.setTransform(a.a,a.b,a.c,a.d,0|a.tx,0|a.ty):e.setTransform(a.a,a.b,a.c,a.d,a.tx,a.ty),e.drawImage(n.texture.baseTexture.source,o.x,o.y,o.width,o.height,n.anchor.x*-o.width+.5|0,n.anchor.y*-o.height+.5|0,o.width,o.height)}}}}}},{"../display/Container":4}],20:[function(t,e){function r(t,e,r){this.gl=t,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<e.length;i++){var s=e[i];s.dynamic?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}r.prototype.constructor=r,e.exports=r,r.prototype.initBuffers=function(){var t,e,r=this.gl,i=0;for(this.dynamicStride=0,t=0;t<this.dynamicProperties.length;t++)e=this.dynamicProperties[t],e.offset=i,i+=e.size,this.dynamicStride+=e.size;this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.dynamicBuffer),r.bufferData(r.ARRAY_BUFFER,this.dynamicData,r.DYNAMIC_DRAW);var s=0;for(this.staticStride=0,t=0;t<this.staticProperties.length;t++)e=this.staticProperties[t],e.offset=s,s+=e.size,this.staticStride+=e.size;this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,this.staticBuffer),r.bufferData(r.ARRAY_BUFFER,this.staticData,r.DYNAMIC_DRAW)},r.prototype.uploadDynamic=function(t,e,r){for(var i=this.gl,s=0;s<this.dynamicProperties.length;s++){var n=this.dynamicProperties[s];n.uploadFunction(t,e,r,this.dynamicData,this.dynamicStride,n.offset)}i.bindBuffer(i.ARRAY_BUFFER,this.dynamicBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,this.dynamicData)},r.prototype.uploadStatic=function(t,e,r){for(var i=this.gl,s=0;s<this.staticProperties.length;s++){var n=this.staticProperties[s];n.uploadFunction(t,e,r,this.staticData,this.staticStride,n.offset)}i.bindBuffer(i.ARRAY_BUFFER,this.staticBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,this.staticData)},r.prototype.bind=function(){var t,e,r=this.gl;for(r.bindBuffer(r.ARRAY_BUFFER,this.dynamicBuffer),t=0;t<this.dynamicProperties.length;t++)e=this.dynamicProperties[t],r.vertexAttribPointer(e.attribute,e.size,r.FLOAT,!1,4*this.dynamicStride,4*e.offset);for(r.bindBuffer(r.ARRAY_BUFFER,this.staticBuffer),t=0;t<this.staticProperties.length;t++)e=this.staticProperties[t],r.vertexAttribPointer(e.attribute,e.size,r.FLOAT,!1,4*this.staticStride,4*e.offset)},r.prototype.destroy=function(){}},{}],21:[function(t,e){function r(t){i.call(this,t),this.size=15e3;var e=6*this.size;this.indices=new Uint16Array(e);for(var r=0,s=0;e>r;r+=6,s+=4)this.indices[r+0]=s+0,this.indices[r+1]=s+1,this.indices[r+2]=s+2,this.indices[r+3]=s+0,this.indices[r+4]=s+2,this.indices[r+5]=s+3;this.shader=null,this.tempMatrix=new a.Matrix}var i=t("../../renderers/webgl/utils/ObjectRenderer"),s=t("../../renderers/webgl/WebGLRenderer"),n=t("./ParticleShader"),o=t("./ParticleBuffer"),a=t("../../math");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,s.registerPlugin("particle",r),r.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new n(this.renderer.shaderManager),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.properties=[{attribute:this.shader.attributes.aVertexPosition,dynamic:!1,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,dynamic:!0,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,dynamic:!1,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,dynamic:!1,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,dynamic:!1,size:1,uploadFunction:this.uploadAlpha,offset:0}]},r.prototype.start=function(){var t=this.renderer.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.shader;this.renderer.shaderManager.setShader(e)},r.prototype.render=function(t){var e=t.children,r=e.length,i=t._size;if(0!==r){r>i&&(r=i),t._buffers||(t._buffers=this.generateBuffers(t));var s=this.renderer.gl,n=t.worldTransform.copy(this.tempMatrix);n.prepend(this.renderer.currentRenderTarget.projectionMatrix),s.uniformMatrix3fv(this.shader.uniforms.projectionMatrix._location,!1,n.toArray(!0));var o=t._updateStatic,a=e[0]._texture.baseTexture;a._glTextures[s.id]?s.bindTexture(s.TEXTURE_2D,a._glTextures[s.id]):(this.renderer.updateTexture(a),this.properties[0].dynamic&&this.properties[3].dynamic||(o=!0));for(var h=0,l=0;r>l;l+=this.size){var u=r-l;u>this.size&&(u=this.size);var c=t._buffers[h++];c.uploadDynamic(e,l,u),o&&c.uploadStatic(e,l,u),c.bind(this.shader),s.drawElements(s.TRIANGLES,6*u,s.UNSIGNED_SHORT,0),this.renderer.drawCount++}t._updateStatic=!1}},r.prototype.generateBuffers=function(t){var e,r=this.renderer.gl,i=[],s=t._size;for(e=0;e<t._properties.length;e++)this.properties[e].dynamic=t._properties[e];for(e=0;s>e;e+=this.size)i.push(new o(r,this.properties,this.size,this.shader));return i},r.prototype.uploadVertices=function(t,e,r,i,s,n){for(var o,a,h,l,u,c,d,p,f,g=0;r>g;g++)o=t[e+g],a=o._texture,l=o.scale.x,u=o.scale.y,a.trim?(h=a.trim,d=h.x-o.anchor.x*h.width,c=d+a.crop.width,f=h.y-o.anchor.y*h.height,p=f+a.crop.height):(c=a._frame.width*(1-o.anchor.x),d=a._frame.width*-o.anchor.x,p=a._frame.height*(1-o.anchor.y),f=a._frame.height*-o.anchor.y),i[n]=d*l,i[n+1]=f*u,i[n+s]=c*l,i[n+s+1]=f*u,i[n+2*s]=c*l,i[n+2*s+1]=p*u,i[n+3*s]=d*l,i[n+3*s+1]=p*u,n+=4*s},r.prototype.uploadPosition=function(t,e,r,i,s,n){for(var o=0;r>o;o++){var a=t[e+o].position;i[n]=a.x,i[n+1]=a.y,i[n+s]=a.x,i[n+s+1]=a.y,i[n+2*s]=a.x,i[n+2*s+1]=a.y,i[n+3*s]=a.x,i[n+3*s+1]=a.y,n+=4*s}},r.prototype.uploadRotation=function(t,e,r,i,s,n){for(var o=0;r>o;o++){var a=t[e+o].rotation;i[n]=a,i[n+s]=a,i[n+2*s]=a,i[n+3*s]=a,n+=4*s}},r.prototype.uploadUvs=function(t,e,r,i,s,n){for(var o=0;r>o;o++){var a=t[e+o]._texture._uvs;a?(i[n]=a.x0,i[n+1]=a.y0,i[n+s]=a.x1,i[n+s+1]=a.y1,i[n+2*s]=a.x2,i[n+2*s+1]=a.y2,i[n+3*s]=a.x3,i[n+3*s+1]=a.y3,n+=4*s):(i[n]=0,i[n+1]=0,i[n+s]=0,i[n+s+1]=0,i[n+2*s]=0,i[n+2*s+1]=0,i[n+3*s]=0,i[n+3*s+1]=0,n+=4*s)}},r.prototype.uploadAlpha=function(t,e,r,i,s,n){for(var o=0;r>o;o++){var a=t[e+o].alpha;i[n]=a,i[n+s]=a,i[n+2*s]=a,i[n+3*s]=a,n+=4*s}},r.prototype.destroy=function(){this.shader.destroy()}},{"../../math":13,"../../renderers/webgl/WebGLRenderer":29,"../../renderers/webgl/utils/ObjectRenderer":43,"./ParticleBuffer":20,"./ParticleShader":22}],22:[function(t,e){function r(t){i.call(this,t,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n"),null,{aPositionCoord:0,aRotation:0})}var i=t("../../renderers/webgl/shaders/TextureShader");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r},{"../../renderers/webgl/shaders/TextureShader":42}],23:[function(t,e){function r(t,e,r,o){if(i.sayHello(t),o)for(var a in n.DEFAULT_RENDER_OPTIONS)"undefined"==typeof o[a]&&(o[a]=n.DEFAULT_RENDER_OPTIONS[a]);else o=n.DEFAULT_RENDER_OPTIONS;this.type=n.RENDERER_TYPE.UNKNOWN,this.width=e||800,this.height=r||600,this.view=o.view||document.createElement("canvas"),this.resolution=o.resolution,this.transparent=o.transparent,this.autoResize=o.autoResize||!1,this.blendModes=null,this.preserveDrawingBuffer=o.preserveDrawingBuffer,this.clearBeforeRender=o.clearBeforeRender,this._backgroundColor=16777215,this._backgroundColorRgb=[1,1,1],this._backgroundColorString="#000000",this.backgroundColor=o.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent={worldTransform:new s.Matrix,worldAlpha:1,children:[]},this._lastObjectRendered=this._tempDisplayObjectParent}var i=t("../utils"),s=t("../math"),n=t("../const");r.prototype.constructor=r,e.exports=r,i.eventTarget.mixin(r.prototype),Object.defineProperties(r.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=i.hex2string(t),i.hex2rgb(t,this._backgroundColorRgb)}}}),r.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},r.prototype.destroy=function(t){t&&this.view.parent&&this.view.parent.removeChild(this.view),this.type=n.RENDERER_TYPE.UNKNOWN,this.width=0,this.height=0,this.view=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgb=null,this._backgroundColorString=null}},{"../const":3,"../math":13,"../utils":57}],24:[function(t,e){function r(t,e,r){i.call(this,"Canvas",t,e,r),this.type=a.RENDERER_TYPE.CANVAS,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.maskManager=new s,this.roundPixels=!1,this.currentScaleMode=a.SCALE_MODES.DEFAULT,this.currentBlendMode=a.BLEND_MODES.NORMAL,this.smoothProperty="imageSmoothingEnabled",this.context.imageSmoothingEnabled||(this.context.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":this.context.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":this.context.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":this.context.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")),this.initPlugins(),this._mapBlendModes(),this._tempDisplayObjectParent={worldTransform:new o.Matrix,worldAlpha:1},this.resize(t,e)}var i=t("../SystemRenderer"),s=t("./utils/CanvasMaskManager"),n=t("../../utils"),o=t("../../math"),a=t("../../const");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,n.pluginTarget.mixin(r),r.prototype.render=function(t){var e=t.parent;this._lastObjectRendered=t,t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=e,this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.currentBlendMode=a.BLEND_MODES.NORMAL,this.context.globalCompositeOperation=this.blendModes[a.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=this._backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(t,this.context)},r.prototype.destroy=function(t){this.destroyPlugins(),i.prototype.destroy.call(this,t),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.roundPixels=!1,this.currentScaleMode=0,this.currentBlendMode=0,this.smoothProperty=null},r.prototype.renderDisplayObject=function(t,e){var r=this.context;this.context=e,t.renderCanvas(this),this.context=r},r.prototype._mapBlendModes=function(){this.blendModes||(this.blendModes={},n.canUseNewCanvasBlendModes()?(this.blendModes[a.BLEND_MODES.NORMAL]="source-over",this.blendModes[a.BLEND_MODES.ADD]="lighter",this.blendModes[a.BLEND_MODES.MULTIPLY]="multiply",this.blendModes[a.BLEND_MODES.SCREEN]="screen",this.blendModes[a.BLEND_MODES.OVERLAY]="overlay",this.blendModes[a.BLEND_MODES.DARKEN]="darken",this.blendModes[a.BLEND_MODES.LIGHTEN]="lighten",this.blendModes[a.BLEND_MODES.COLOR_DODGE]="color-dodge",this.blendModes[a.BLEND_MODES.COLOR_BURN]="color-burn",this.blendModes[a.BLEND_MODES.HARD_LIGHT]="hard-light",this.blendModes[a.BLEND_MODES.SOFT_LIGHT]="soft-light",this.blendModes[a.BLEND_MODES.DIFFERENCE]="difference",this.blendModes[a.BLEND_MODES.EXCLUSION]="exclusion",this.blendModes[a.BLEND_MODES.HUE]="hue",this.blendModes[a.BLEND_MODES.SATURATION]="saturation",this.blendModes[a.BLEND_MODES.COLOR]="color",this.blendModes[a.BLEND_MODES.LUMINOSITY]="luminosity"):(this.blendModes[a.BLEND_MODES.NORMAL]="source-over",this.blendModes[a.BLEND_MODES.ADD]="lighter",this.blendModes[a.BLEND_MODES.MULTIPLY]="source-over",this.blendModes[a.BLEND_MODES.SCREEN]="source-over",this.blendModes[a.BLEND_MODES.OVERLAY]="source-over",this.blendModes[a.BLEND_MODES.DARKEN]="source-over",this.blendModes[a.BLEND_MODES.LIGHTEN]="source-over",this.blendModes[a.BLEND_MODES.COLOR_DODGE]="source-over",this.blendModes[a.BLEND_MODES.COLOR_BURN]="source-over",this.blendModes[a.BLEND_MODES.HARD_LIGHT]="source-over",this.blendModes[a.BLEND_MODES.SOFT_LIGHT]="source-over",this.blendModes[a.BLEND_MODES.DIFFERENCE]="source-over",this.blendModes[a.BLEND_MODES.EXCLUSION]="source-over",this.blendModes[a.BLEND_MODES.HUE]="source-over",this.blendModes[a.BLEND_MODES.SATURATION]="source-over",this.blendModes[a.BLEND_MODES.COLOR]="source-over",this.blendModes[a.BLEND_MODES.LUMINOSITY]="source-over"))}},{"../../const":3,"../../math":13,"../../utils":57,"../SystemRenderer":23,"./utils/CanvasMaskManager":27}],25:[function(t,e){function r(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e}r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{width:{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},height:{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}}),r.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},r.prototype.resize=function(t,e){this.canvas.width=t,this.canvas.height=e},r.prototype.destroy=function(){this.context=null,this.canvas=null}},{}],26:[function(t,e){var r=t("../../../const"),i=e.exports={};i.renderGraphics=function(t,e){var i=t.worldAlpha;t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1);for(var s=0;s<t.graphicsData.length;s++){var n=t.graphicsData[s],o=n.shape,a=n._fillTint,h=n._lineTint;if(e.lineWidth=n.lineWidth,n.type===r.SHAPES.POLY){e.beginPath();var l=o.points;e.moveTo(l[0],l[1]);for(var u=1;u<l.length/2;u++)e.lineTo(l[2*u],l[2*u+1]);o.closed&&e.lineTo(l[0],l[1]),l[0]===l[l.length-2]&&l[1]===l[l.length-1]&&e.closePath(),n.fill&&(e.globalAlpha=n.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),n.lineWidth&&(e.globalAlpha=n.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.stroke())}else if(n.type===r.SHAPES.RECT)(n.fillColor||0===n.fillColor)&&(e.globalAlpha=n.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fillRect(o.x,o.y,o.width,o.height)),n.lineWidth&&(e.globalAlpha=n.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.strokeRect(o.x,o.y,o.width,o.height));else if(n.type===r.SHAPES.CIRC)e.beginPath(),e.arc(o.x,o.y,o.radius,0,2*Math.PI),e.closePath(),n.fill&&(e.globalAlpha=n.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),n.lineWidth&&(e.globalAlpha=n.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.stroke());else if(n.type===r.SHAPES.ELIP){var c=2*o.width,d=2*o.height,p=o.x-c/2,f=o.y-d/2;e.beginPath();var g=.5522848,y=c/2*g,x=d/2*g,v=p+c,m=f+d,E=p+c/2,b=f+d/2;e.moveTo(p,b),e.bezierCurveTo(p,b-x,E-y,f,E,f),e.bezierCurveTo(E+y,f,v,b-x,v,b),e.bezierCurveTo(v,b+x,E+y,m,E,m),e.bezierCurveTo(E-y,m,p,b+x,p,b),e.closePath(),n.fill&&(e.globalAlpha=n.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),n.lineWidth&&(e.globalAlpha=n.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.stroke())}else if(n.type===r.SHAPES.RREC){var _=o.x,T=o.y,R=o.width,S=o.height,A=o.radius,w=Math.min(R,S)/2|0;A=A>w?w:A,e.beginPath(),e.moveTo(_,T+A),e.lineTo(_,T+S-A),e.quadraticCurveTo(_,T+S,_+A,T+S),e.lineTo(_+R-A,T+S),e.quadraticCurveTo(_+R,T+S,_+R,T+S-A),e.lineTo(_+R,T+A),e.quadraticCurveTo(_+R,T,_+R-A,T),e.lineTo(_+A,T),e.quadraticCurveTo(_,T,_,T+A),e.closePath(),(n.fillColor||0===n.fillColor)&&(e.globalAlpha=n.fillAlpha*i,e.fillStyle="#"+("00000"+(0|a).toString(16)).substr(-6),e.fill()),n.lineWidth&&(e.globalAlpha=n.lineAlpha*i,e.strokeStyle="#"+("00000"+(0|h).toString(16)).substr(-6),e.stroke())}}},i.renderGraphicsMask=function(t,e){var i=t.graphicsData.length;if(0!==i){e.beginPath();for(var s=0;i>s;s++){var n=t.graphicsData[s],o=n.shape;if(n.type===r.SHAPES.POLY){var a=o.points;e.moveTo(a[0],a[1]);for(var h=1;h<a.length/2;h++)e.lineTo(a[2*h],a[2*h+1]);a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath()}else if(n.type===r.SHAPES.RECT)e.rect(o.x,o.y,o.width,o.height),e.closePath();else if(n.type===r.SHAPES.CIRC)e.arc(o.x,o.y,o.radius,0,2*Math.PI),e.closePath();else if(n.type===r.SHAPES.ELIP){var l=2*o.width,u=2*o.height,c=o.x-l/2,d=o.y-u/2,p=.5522848,f=l/2*p,g=u/2*p,y=c+l,x=d+u,v=c+l/2,m=d+u/2;e.moveTo(c,m),e.bezierCurveTo(c,m-g,v-f,d,v,d),e.bezierCurveTo(v+f,d,y,m-g,y,m),e.bezierCurveTo(y,m+g,v+f,x,v,x),e.bezierCurveTo(v-f,x,c,m+g,c,m),e.closePath()}else if(n.type===r.SHAPES.RREC){var E=o.x,b=o.y,_=o.width,T=o.height,R=o.radius,S=Math.min(_,T)/2|0;R=R>S?S:R,e.moveTo(E,b+R),e.lineTo(E,b+T-R),e.quadraticCurveTo(E,b+T,E+R,b+T),e.lineTo(E+_-R,b+T),e.quadraticCurveTo(E+_,b+T,E+_,b+T-R),e.lineTo(E+_,b+R),e.quadraticCurveTo(E+_,b,E+_-R,b),e.lineTo(E+R,b),e.quadraticCurveTo(E,b,E,b+R),e.closePath()}}}},i.updateGraphicsTint=function(t){if(16777215!==t.tint)for(var e=(t.tint>>16&255)/255,r=(t.tint>>8&255)/255,i=(255&t.tint)/255,s=0;s<t.graphicsData.length;s++){var n=t.graphicsData[s],o=0|n.fillColor,a=0|n.lineColor;n._fillTint=((o>>16&255)/255*e*255<<16)+((o>>8&255)/255*r*255<<8)+(255&o)/255*i*255,n._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*r*255<<8)+(255&a)/255*i*255}}},{"../../../const":3}],27:[function(t,e){function r(){}var i=t("./CanvasGraphics");r.prototype.constructor=r,e.exports=r,r.prototype.pushMask=function(t,e){e.context.save();var r=t.alpha,s=t.worldTransform,n=e.resolution;e.context.setTransform(s.a*n,s.b*n,s.c*n,s.d*n,s.tx*n,s.ty*n),t.texture||(i.renderGraphicsMask(t,e.context),e.context.clip()),t.worldAlpha=r},r.prototype.popMask=function(t){t.context.restore()}},{"./CanvasGraphics":26}],28:[function(t,e){var r=t("../../../utils"),i=e.exports={};i.getTintedTexture=function(t,e){var r=t.texture;e=i.roundColor(e);var s="#"+("00000"+(0|e).toString(16)).substr(-6);if(r.tintCache=r.tintCache||{},r.tintCache[s])return r.tintCache[s];var n=i.canvas||document.createElement("canvas");if(i.tintMethod(r,e,n),i.convertTintToImage){var o=new Image;o.src=n.toDataURL(),r.tintCache[s]=o}else r.tintCache[s]=n,i.canvas=null;return n},i.tintWithMultiply=function(t,e,r){var i=r.getContext("2d"),s=t.crop;r.width=s.width,r.height=s.height,i.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),i.fillRect(0,0,s.width,s.height),i.globalCompositeOperation="multiply",i.drawImage(t.baseTexture.source,s.x,s.y,s.width,s.height,0,0,s.width,s.height),i.globalCompositeOperation="destination-atop",i.drawImage(t.baseTexture.source,s.x,s.y,s.width,s.height,0,0,s.width,s.height)},i.tintWithOverlay=function(t,e,r){var i=r.getContext("2d"),s=t.crop;r.width=s.width,r.height=s.height,i.globalCompositeOperation="copy",i.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),i.fillRect(0,0,s.width,s.height),i.globalCompositeOperation="destination-atop",i.drawImage(t.baseTexture.source,s.x,s.y,s.width,s.height,0,0,s.width,s.height)},i.tintWithPerPixel=function(t,e,i){var s=i.getContext("2d"),n=t.crop;i.width=n.width,i.height=n.height,s.globalCompositeOperation="copy",s.drawImage(t.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height);for(var o=r.hex2rgb(e),a=o[0],h=o[1],l=o[2],u=s.getImageData(0,0,n.width,n.height),c=u.data,d=0;d<c.length;d+=4)c[d+0]*=a,c[d+1]*=h,c[d+2]*=l;s.putImageData(u,0,0)},i.roundColor=function(t){var e=i.cacheStepsPerColorChannel,s=r.hex2rgb(t);return s[0]=Math.min(255,s[0]/e*e),s[1]=Math.min(255,s[1]/e*e),s[2]=Math.min(255,s[2]/e*e),r.rgb2hex(s)},i.cacheStepsPerColorChannel=8,i.convertTintToImage=!1,i.canUseMultiply=r.canUseNewCanvasBlendModes(),i.tintMethod=i.canUseMultiply?i.tintWithMultiply:i.tintWithPerPixel},{"../../../utils":57}],29:[function(t,e){function r(t,e,r){r=r||{},i.call(this,"WebGL",t,e,r),this.type=p.RENDERER_TYPE.WEBGL,this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),this._updateTextureBound=function(t){this.updateTexture(t.target)}.bind(this),this._destroyTextureBound=function(t){this.destroyTexture(t.target)}.bind(this),this.view.addEventListener("webglcontextlost",this.handleContextLost,!1),this.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this._useFXAA=!!r.forceFXAA&&r.antialias,this._FXAAFilter=null,this._contextOptions={alpha:this.transparent,antialias:r.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer},this.drawCount=0,this.shaderManager=new s(this),this.maskManager=new n(this),this.stencilManager=new o(this),this.filterManager=new a(this),this.blendModeManager=new h(this),this.currentRenderTarget=this.renderTarget,this.currentRenderer=new u(this),this.initPlugins(),this._initContext(),this._mapBlendModes(),this._renderTargetStack=[]}var i=t("../SystemRenderer"),s=t("./managers/ShaderManager"),n=t("./managers/MaskManager"),o=t("./managers/StencilManager"),a=t("./managers/FilterManager"),h=t("./managers/BlendModeManager"),l=t("./utils/RenderTarget"),u=t("./utils/ObjectRenderer"),c=t("./filters/FXAAFilter"),d=t("../../utils"),p=t("../../const");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,d.pluginTarget.mixin(r),r.glContextId=0,r.prototype._initContext=function(){var t=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=t,!t)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=r.glContextId++,t.id=this.glContextId,t.renderer=this,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),this.renderTarget=new l(this.gl,this.width,this.height,null,this.resolution,!0),this.emit("context",t),this.resize(this.width,this.height),this._useFXAA||(this._useFXAA=this._contextOptions.antialias&&!t.getContextAttributes().antialias),this._useFXAA&&(window.console.warn("FXAA antialiasing being used instead of native antialiasing"),this._FXAAFilter=[new c])},r.prototype.render=function(t){if(!this.gl.isContextLost()){this._lastObjectRendered=t,this._useFXAA&&(this._FXAAFilter[0].uniforms.resolution.value.x=this.width,this._FXAAFilter[0].uniforms.resolution.value.y=this.height,t.filterArea=this.renderTarget.size,t.filters=this._FXAAFilter);var e=t.parent;t.parent=this._tempDisplayObjectParent,t.updateTransform(),t.parent=e;var r=this.gl;this.setRenderTarget(this.renderTarget),this.clearBeforeRender&&(this.transparent?r.clearColor(0,0,0,0):r.clearColor(this._backgroundColorRgb[0],this._backgroundColorRgb[1],this._backgroundColorRgb[2],1),r.clear(r.COLOR_BUFFER_BIT)),this.renderDisplayObject(t,this.renderTarget)}},r.prototype.renderDisplayObject=function(t,e){this.setRenderTarget(e),this.filterManager.setFilterStack(e.filterStack),t.renderWebGL(this),this.currentRenderer.flush()},r.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},r.prototype.setRenderTarget=function(t){this.currentRenderTarget!==t&&(this.currentRenderTarget=t,this.currentRenderTarget.activate(),this.stencilManager.setMaskStack(t.stencilMaskStack))},r.prototype.resize=function(t,e){i.prototype.resize.call(this,t,e),this.filterManager.resize(t,e),this.renderTarget.resize(t,e),this.currentRenderTarget===this.renderTarget&&this.renderTarget.activate()},r.prototype.updateTexture=function(t){if(t=t.baseTexture||t,t.hasLoaded){var e=this.gl;return t._glTextures[e.id]||(t._glTextures[e.id]=e.createTexture(),t.on("update",this._updateTextureBound),t.on("dispose",this._destroyTextureBound)),e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===p.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST),t.mipmap&&t.isPowerOfTwo?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===p.SCALE_MODES.LINEAR?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===p.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST),t.isPowerOfTwo?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),t._glTextures[e.id]}},r.prototype.destroyTexture=function(t){t=t.baseTexture||t,t.hasLoaded&&t._glTextures[this.gl.id]&&this.gl.deleteTexture(t._glTextures[this.gl.id])},r.prototype.handleContextLost=function(t){t.preventDefault()},r.prototype.handleContextRestored=function(){this._initContext();for(var t in d.BaseTextureCache)d.BaseTextureCache[t]._glTextures.length=0},r.prototype.destroy=function(t){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored),i.prototype.destroy.call(this,t),this.uuid=0,this.shaderManager.destroy(),this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.maskManager=null,this.filterManager=null,this.blendModeManager=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.drawCount=0,this.gl=null
},r.prototype._mapBlendModes=function(){var t=this.gl;this.blendModes||(this.blendModes={},this.blendModes[p.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.ADD]=[t.SRC_ALPHA,t.DST_ALPHA],this.blendModes[p.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.SCREEN]=[t.SRC_ALPHA,t.ONE],this.blendModes[p.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],this.blendModes[p.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA])}},{"../../const":3,"../../utils":57,"../SystemRenderer":23,"./filters/FXAAFilter":31,"./managers/BlendModeManager":33,"./managers/FilterManager":34,"./managers/MaskManager":35,"./managers/ShaderManager":36,"./managers/StencilManager":37,"./utils/ObjectRenderer":43,"./utils/RenderTarget":45}],30:[function(t,e){function r(t,e,r){this.shaders=[],this.padding=0,this.uniforms=r||{},this.vertexSrc=t||i.defaultVertexSrc,this.fragmentSrc=e||i.defaultFragmentSrc}var i=t("../shaders/TextureShader");r.prototype.constructor=r,e.exports=r,r.prototype.getShader=function(t){var e=t.gl,r=this.shaders[e.id];return r||(r=new i(t.shaderManager,this.vertexSrc,this.fragmentSrc,this.uniforms,this.attributes),this.shaders[e.id]=r),r},r.prototype.applyFilter=function(t,e,r,i){var s=this.getShader(t);t.filterManager.applyFilter(s,e,r,i)},r.prototype.syncUniform=function(t){for(var e=0,r=this.shaders.length;r>e;++e)this.shaders[e].syncUniform(t)}},{"../shaders/TextureShader":42}],31:[function(t,e){(function(r){function i(){s.call(this,n.readFileSync(r+"/FXAA.vert","utf8"),n.readFileSync(r+"/FXAA.frag","utf8"),{resolution:{type:"v2",value:{x:1,y:1}}})}var s=t("./AbstractFilter"),n=t("fs");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,r){var i=t.filterManager,s=this.getShader(t);i.applyFilter(s,e,r)}}).call(this,"/lib/pixi/src/core/renderers/webgl/filters")},{"./AbstractFilter":30,fs:60}],32:[function(t,e){(function(r){function i(t){var e=new n.Matrix;s.call(this,o.readFileSync(r+"/spriteMaskFilter.vert","utf8"),o.readFileSync(r+"/spriteMaskFilter.frag","utf8"),{mask:{type:"sampler2D",value:t._texture},alpha:{type:"f",value:1},otherMatrix:{type:"mat3",value:e.toArray(!0)}}),this.maskSprite=t,this.maskMatrix=e}var s=t("./AbstractFilter"),n=t("../../../math"),o=t("fs");i.prototype=Object.create(s.prototype),i.prototype.constructor=i,e.exports=i,i.prototype.applyFilter=function(t,e,r){var i=t.filterManager;this.uniforms.mask.value=this.maskSprite._texture,i.calculateMappedMatrix(e.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.alpha.value=this.maskSprite.worldAlpha;var s=this.getShader(t);i.applyFilter(s,e,r)},Object.defineProperties(i.prototype,{map:{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value=t}},offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}})}).call(this,"/lib/pixi/src/core/renderers/webgl/filters")},{"../../../math":13,"./AbstractFilter":30,fs:60}],33:[function(t,e){function r(t){i.call(this,t),this.currentBlendMode=99999}var i=t("./WebGLManager");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;var e=this.renderer.blendModes[this.currentBlendMode];return this.renderer.gl.blendFunc(e[0],e[1]),!0}},{"./WebGLManager":38}],34:[function(t,e){function r(t){i.call(this,t),this.filterStack=[],this.filterStack.push({renderTarget:t.currentRenderTarget,filter:[],bounds:null}),this.texturePool=[],this.textureSize=new a.Rectangle(0,0,t.width,t.height),this.currentFrame=null}var i=t("./WebGLManager"),s=t("../utils/RenderTarget"),n=t("../../../const"),o=t("../utils/Quad"),a=t("../../../math");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.onContextChange=function(){this.texturePool.length=0;var t=this.renderer.gl;this.quad=new o(t)},r.prototype.setFilterStack=function(t){this.filterStack=t},r.prototype.pushFilter=function(t,e){var r=t.filterArea||t.getBounds();r.x=0|r.x,r.y=0|r.y,r.width=0|r.width,r.height=0|r.height;var i=0|e[0].padding;if(r.x-=i,r.y-=i,r.width+=2*i,r.height+=2*i,this.renderer.currentRenderTarget.transform){var s=this.renderer.currentRenderTarget.transform;r.x+=s.tx,r.y+=s.ty,this.capFilterArea(r),r.x-=s.tx,r.y-=s.ty}else this.capFilterArea(r);this.currentFrame=r;var n=this.getRenderTarget();this.renderer.setRenderTarget(n),n.clear(),this.filterStack.push({renderTarget:n,filter:e})},r.prototype.popFilter=function(){var t=this.filterStack.pop(),e=this.filterStack[this.filterStack.length-1],r=t.renderTarget,i=e.renderTarget,s=this.renderer.gl;this.currentFrame=r.frame,this.quad.map(this.textureSize,r.frame),s.bindBuffer(s.ARRAY_BUFFER,this.quad.vertexBuffer),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.quad.indexBuffer);var n=t.filter;if(s.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aVertexPosition,2,s.FLOAT,!1,0,0),s.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aTextureCoord,2,s.FLOAT,!1,0,32),s.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aColor,4,s.FLOAT,!1,0,64),1===n.length)n[0].uniforms.dimensions&&(n[0].uniforms.dimensions.value[0]=this.renderer.width,n[0].uniforms.dimensions.value[1]=this.renderer.height,n[0].uniforms.dimensions.value[2]=this.quad.vertices[0],n[0].uniforms.dimensions.value[3]=this.quad.vertices[5]),n[0].applyFilter(this.renderer,r,i),this.returnRenderTarget(r);else{for(var o=r,a=this.getRenderTarget(!0),h=0;h<n.length-1;h++){var l=n[h];l.uniforms.dimensions&&(l.uniforms.dimensions.value[0]=this.renderer.width,l.uniforms.dimensions.value[1]=this.renderer.height,l.uniforms.dimensions.value[2]=this.quad.vertices[0],l.uniforms.dimensions.value[3]=this.quad.vertices[5]),l.applyFilter(this.renderer,o,a);var u=o;o=a,a=u}n[n.length-1].applyFilter(this.renderer,o,i),this.returnRenderTarget(o),this.returnRenderTarget(a)}return t.filter},r.prototype.getRenderTarget=function(t){var e=this.texturePool.pop()||new s(this.renderer.gl,this.textureSize.width,this.textureSize.height,n.SCALE_MODES.LINEAR,this.renderer.resolution*n.FILTER_RESOLUTION);return e.frame=this.currentFrame,t&&e.clear(!0),e},r.prototype.returnRenderTarget=function(t){this.texturePool.push(t)},r.prototype.applyFilter=function(t,e,r,i){var s=this.renderer.gl;this.renderer.setRenderTarget(r),i&&r.clear(),this.renderer.shaderManager.setShader(t),t.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),t.syncUniforms(),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,e.texture),s.drawElements(s.TRIANGLES,6,s.UNSIGNED_SHORT,0)},r.prototype.calculateMappedMatrix=function(t,e,r){var i=e.worldTransform.copy(a.Matrix.TEMP_MATRIX),s=e._texture.baseTexture,n=r.identity(),o=this.textureSize.height/this.textureSize.width;n.translate(t.x/this.textureSize.width,t.y/this.textureSize.height),n.scale(1,o);var h=this.textureSize.width/s.width,l=this.textureSize.height/s.height;return i.tx/=s.width*h,i.ty/=s.width*h,i.invert(),n.prepend(i),n.scale(1,1/o),n.scale(h,l),n.translate(e.anchor.x,e.anchor.y),n},r.prototype.capFilterArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0),t.x+t.width>this.textureSize.width&&(t.width=this.textureSize.width-t.x),t.y+t.height>this.textureSize.height&&(t.height=this.textureSize.height-t.y)},r.prototype.resize=function(t,e){this.textureSize.width=t,this.textureSize.height=e;for(var r=0;r<this.texturePool.length;r++)this.texturePool[r].resize(t,e)},r.prototype.destroy=function(){this.filterStack=null,this.offsetY=0;for(var t=0;t<this.texturePool.length;t++)this.texturePool[t].destroy();this.texturePool=null}},{"../../../const":3,"../../../math":13,"../utils/Quad":44,"../utils/RenderTarget":45,"./WebGLManager":38}],35:[function(t,e){function r(t){i.call(this,t),this.stencilStack=[],this.reverse=!0,this.count=0,this.alphaMaskPool=[]}var i=t("./WebGLManager"),s=t("../filters/SpriteMaskFilter");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.pushMask=function(t,e){e.texture?this.pushSpriteMask(t,e):this.pushStencilMask(t,e)},r.prototype.popMask=function(t,e){e.texture?this.popSpriteMask(t,e):this.popStencilMask(t,e)},r.prototype.pushSpriteMask=function(t,e){var r=this.alphaMaskPool.pop();r||(r=[new s(e)]),this.renderer.filterManager.pushFilter(t,r)},r.prototype.popSpriteMask=function(){var t=this.renderer.filterManager.popFilter();this.alphaMaskPool.push(t)},r.prototype.pushStencilMask=function(t,e){this.renderer.stencilManager.pushMask(e)},r.prototype.popStencilMask=function(t,e){this.renderer.stencilManager.popMask(e)}},{"../filters/SpriteMaskFilter":32,"./WebGLManager":38}],36:[function(t,e){function r(t){i.call(this,t),this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.stack=[],this._currentId=-1,this.currentShader=null}var i=t("./WebGLManager"),s=t("../shaders/TextureShader"),n=t("../shaders/ComplexPrimitiveShader"),o=t("../shaders/PrimitiveShader"),a=t("../../../utils");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,a.pluginTarget.mixin(r),e.exports=r,r.prototype.onContextChange=function(){this.initPlugins(),this.defaultShader=new s(this),this.primitiveShader=new o(this),this.complexPrimitiveShader=new n(this)},r.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(var r in t)this.tempAttribState[t[r]]=!0;var i=this.renderer.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.attribState[e]?i.enableVertexAttribArray(e):i.disableVertexAttribArray(e))},r.prototype.setShader=function(t){return this._currentId===t.uuid?!1:(this._currentId=t.uuid,this.currentShader=t,this.renderer.gl.useProgram(t.program),this.setAttribs(t.attributes),!0)},r.prototype.destroy=function(){i.prototype.destroy.call(this),this.destroyPlugins(),this.attribState=null,this.tempAttribState=null}},{"../../../utils":57,"../shaders/ComplexPrimitiveShader":39,"../shaders/PrimitiveShader":40,"../shaders/TextureShader":42,"./WebGLManager":38}],37:[function(t,e){function r(t){i.call(this,t),this.stencilMaskStack=null}var i=t("./WebGLManager"),s=t("../../../utils");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;0===t.stencilStack.length?e.disable(e.STENCIL_TEST):e.enable(e.STENCIL_TEST)},r.prototype.pushStencil=function(t,e){this.renderer.currentRenderTarget.attachStencilBuffer();var r=this.renderer.gl,i=this.stencilMaskStack;this.bindGraphics(t,e,this.renderer),0===i.stencilStack.length&&(r.enable(r.STENCIL_TEST),r.clear(r.STENCIL_BUFFER_BIT),i.reverse=!0,i.count=0),i.stencilStack.push(e);var s=i.count;r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.ALWAYS,0,255),r.stencilOp(r.KEEP,r.KEEP,r.INVERT),1===e.mode?(r.drawElements(r.TRIANGLE_FAN,e.indices.length-4,r.UNSIGNED_SHORT,0),i.reverse?(r.stencilFunc(r.EQUAL,255-s,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)):(r.stencilFunc(r.EQUAL,s,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(e.indices.length-4)),i.reverse?r.stencilFunc(r.EQUAL,255-(s+1),255):r.stencilFunc(r.EQUAL,s+1,255),i.reverse=!i.reverse):(i.reverse?(r.stencilFunc(r.EQUAL,s,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)):(r.stencilFunc(r.EQUAL,255-s,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)),r.drawElements(r.TRIANGLE_STRIP,e.indices.length,r.UNSIGNED_SHORT,0),i.reverse?r.stencilFunc(r.EQUAL,s+1,255):r.stencilFunc(r.EQUAL,255-(s+1),255)),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),i.count++},r.prototype.bindGraphics=function(t,e){this._currentGraphics=t;var r,i=this.renderer.gl;1===e.mode?(r=this.renderer.shaderManager.complexPrimitiveShader,this.renderer.shaderManager.setShader(r),i.uniformMatrix3fv(r.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),i.uniformMatrix3fv(r.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),i.uniform3fv(r.uniforms.tint._location,s.hex2rgb(t.tint)),i.uniform3fv(r.uniforms.color._location,e.color),i.uniform1f(r.uniforms.alpha._location,t.worldAlpha),i.bindBuffer(i.ARRAY_BUFFER,e.buffer),i.vertexAttribPointer(r.attributes.aVertexPosition,2,i.FLOAT,!1,8,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.indexBuffer)):(r=this.renderer.shaderManager.primitiveShader,this.renderer.shaderManager.setShader(r),i.uniformMatrix3fv(r.uniforms.translationMatrix._location,!1,t.worldTransform.toArray(!0)),i.uniformMatrix3fv(r.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),i.uniform3fv(r.uniforms.tint._location,s.hex2rgb(t.tint)),i.uniform1f(r.uniforms.alpha._location,t.worldAlpha),i.bindBuffer(i.ARRAY_BUFFER,e.buffer),i.vertexAttribPointer(r.attributes.aVertexPosition,2,i.FLOAT,!1,24,0),i.vertexAttribPointer(r.attributes.aColor,4,i.FLOAT,!1,24,8),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.indexBuffer))},r.prototype.popStencil=function(t,e){var r=this.renderer.gl,i=this.stencilMaskStack;if(i.stencilStack.pop(),i.count--,0===i.stencilStack.length)r.disable(r.STENCIL_TEST);else{var s=i.count;this.bindGraphics(t,e,this.renderer),r.colorMask(!1,!1,!1,!1),1===e.mode?(i.reverse=!i.reverse,i.reverse?(r.stencilFunc(r.EQUAL,255-(s+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)):(r.stencilFunc(r.EQUAL,s+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(e.indices.length-4)),r.stencilFunc(r.ALWAYS,0,255),r.stencilOp(r.KEEP,r.KEEP,r.INVERT),r.drawElements(r.TRIANGLE_FAN,e.indices.length-4,r.UNSIGNED_SHORT,0),i.reverse?r.stencilFunc(r.EQUAL,s,255):r.stencilFunc(r.EQUAL,255-s,255)):(i.reverse?(r.stencilFunc(r.EQUAL,s+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)):(r.stencilFunc(r.EQUAL,255-(s+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)),r.drawElements(r.TRIANGLE_STRIP,e.indices.length,r.UNSIGNED_SHORT,0),i.reverse?r.stencilFunc(r.EQUAL,s,255):r.stencilFunc(r.EQUAL,255-s,255)),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}},r.prototype.destroy=function(){i.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},r.prototype.pushMask=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),t.dirty&&this.renderer.plugins.graphics.updateGraphics(t,this.renderer.gl),t._webGL[this.renderer.gl.id].data.length&&this.pushStencil(t,t._webGL[this.renderer.gl.id].data[0],this.renderer)},r.prototype.popMask=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.popStencil(t,t._webGL[this.renderer.gl.id].data[0],this.renderer)}},{"../../../utils":57,"./WebGLManager":38}],38:[function(t,e){function r(t){this.renderer=t;var e=this;this.renderer.on("context",this._onContextChangeFn=function(){e.onContextChange()})}r.prototype.constructor=r,e.exports=r,r.prototype.onContextChange=function(){},r.prototype.destroy=function(){this.renderer.off("context",this._onContextChangeFn),this.renderer=null}},{}],39:[function(t,e){function r(t){i.call(this,t,["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},color:{type:"3f",value:[0,0,0]},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0})}var i=t("./Shader");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r},{"./Shader":41}],40:[function(t,e){function r(t){i.call(this,t,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aColor:0})}var i=t("./Shader");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r},{"./Shader":41}],41:[function(t,e){function r(t,e,r,s,n){if(!e||!r)throw new Error("Pixi.js Error. Shader requires vertexSrc and fragmentSrc");this.uuid=i.uuid(),this.gl=t.renderer.gl,this.shaderManager=t,this.program=null,this.uniforms=s||{},this.attributes=n||{},this.textureCount=1,this.vertexSrc=e,this.fragmentSrc=r,this.init()}{var i=t("../../../utils");t("../../../const")}r.prototype.constructor=r,e.exports=r,r.prototype.init=function(){this.compile(),this.gl.useProgram(this.program),this.cacheUniformLocations(Object.keys(this.uniforms)),this.cacheAttributeLocations(Object.keys(this.attributes))},r.prototype.cacheUniformLocations=function(t){for(var e=0;e<t.length;++e)this.uniforms[t[e]]._location=this.gl.getUniformLocation(this.program,t[e])},r.prototype.cacheAttributeLocations=function(t){for(var e=0;e<t.length;++e)this.attributes[t[e]]=this.gl.getAttribLocation(this.program,t[e])},r.prototype.compile=function(){var t=this.gl,e=this._glCompile(t.VERTEX_SHADER,this.vertexSrc),r=this._glCompile(t.FRAGMENT_SHADER,this.fragmentSrc),i=t.createProgram();return t.attachShader(i,e),t.attachShader(i,r),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(i,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(i)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(i)),t.deleteProgram(i),i=null),t.deleteShader(e),t.deleteShader(r),this.program=i},r.prototype.syncUniform=function(t){var e,r,s=t._location,n=t.value,o=this.gl;switch(t.type){case"i":case"1i":o.uniform1i(s,n);break;case"f":case"1f":o.uniform1f(s,n);break;case"2f":o.uniform2f(s,n[0],n[1]);break;case"3f":o.uniform3f(s,n[0],n[1],n[2]);break;case"4f":o.uniform4f(s,n[0],n[1],n[2],n[3]);break;case"v2":o.uniform2f(s,n.x,n.y);break;case"v3":o.uniform3f(s,n.x,n.y,n.z);break;case"v4":o.uniform4f(s,n.x,n.y,n.z,n.w);break;case"1iv":o.uniform1iv(s,n);break;case"2iv":o.uniform2iv(s,n);break;case"3iv":o.uniform3iv(s,n);break;case"4iv":o.uniform4iv(s,n);break;case"1fv":o.uniform1fv(s,n);break;case"2fv":o.uniform2fv(s,n);break;case"3fv":o.uniform3fv(s,n);break;case"4fv":o.uniform4fv(s,n);break;case"m2":case"mat2":case"Matrix2fv":o.uniformMatrix2fv(s,t.transpose,n);break;case"m3":case"mat3":case"Matrix3fv":o.uniformMatrix3fv(s,t.transpose,n);break;case"m4":case"mat4":case"Matrix4fv":o.uniformMatrix4fv(s,t.transpose,n);break;case"c":"number"==typeof n&&(n=i.hex2rgb(n)),o.uniform3f(s,n[0],n[1],n[2]);break;case"iv1":o.uniform1iv(s,n);break;case"iv":o.uniform3iv(s,n);break;case"fv1":o.uniform1fv(s,n);break;case"fv":o.uniform3fv(s,n);break;case"v2v":for(t._array||(t._array=new Float32Array(2*n.length)),e=0,r=n.length;r>e;++e)t._array[2*e]=n[e].x,t._array[2*e+1]=n[e].y;o.uniform2fv(s,t._array);break;case"v3v":for(t._array||(t._array=new Float32Array(3*n.length)),e=0,r=n.length;r>e;++e)t._array[3*e]=n[e].x,t._array[3*e+1]=n[e].y,t._array[3*e+2]=n[e].z;o.uniform3fv(s,t._array);break;case"v4v":for(t._array||(t._array=new Float32Array(4*n.length)),e=0,r=n.length;r>e;++e)t._array[4*e]=n[e].x,t._array[4*e+1]=n[e].y,t._array[4*e+2]=n[e].z,t._array[4*e+3]=n[e].w;o.uniform4fv(s,t._array);break;case"t":case"sampler2D":if(!t.value||!t.value.baseTexture.hasLoaded)break;o.activeTexture(o["TEXTURE"+this.textureCount]);var a=t.value.baseTexture._glTextures[o.id];a||this.initSampler2D(t),o.bindTexture(o.TEXTURE_2D,a),o.uniform1i(t._location,this.textureCount),this.textureCount++;break;default:window.console.warn("Pixi.js Shader Warning: Unknown uniform type: "+t.type)}},r.prototype.syncUniforms=function(){this.textureCount=1;for(var t in this.uniforms)this.syncUniform(this.uniforms[t])},r.prototype.initSampler2D=function(t){var e=this.gl,r=t.value.baseTexture;if(r.hasLoaded)if(t.textureData){var i=t.textureData;r._glTextures[e.id]=e.createTexture(),e.bindTexture(e.TEXTURE_2D,r._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,i.luminance?e.LUMINANCE:e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i.magFilter?i.magFilter:e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i.wrapS?i.wrapS:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,i.wrapS?i.wrapS:e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,i.wrapT?i.wrapT:e.CLAMP_TO_EDGE)}else this.shaderManager.renderer.updateTexture(r)},r.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.gl=null,this.uniforms=null,this.attributes=null,this.vertexSrc=null,this.fragmentSrc=null},r.prototype._glCompile=function(t,e){var r=this.gl.createShader(t);return this.gl.shaderSource(r,e),this.gl.compileShader(r),this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)?r:(window.console.log(this.gl.getShaderInfoLog(r)),null)}},{"../../../const":3,"../../../utils":57}],42:[function(t,e){function r(t,e,s,n,o){var a={uSampler:{type:"sampler2D",value:0},projectionMatrix:{type:"mat3",value:new Float32Array(1,0,0,0,1,0,0,0,1)}};if(n)for(var h in n)a[h]=n[h];var l={aVertexPosition:0,aTextureCoord:0,aColor:0};if(o)for(var u in o)l[u]=o[u];e=e||r.defaultVertexSrc,s=s||r.defaultFragmentSrc,i.call(this,t,e,s,a,l)}var i=t("./Shader");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,r.defaultVertexSrc=["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),r.defaultFragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n")},{"./Shader":41}],43:[function(t,e){function r(t){i.call(this,t)}var i=t("../managers/WebGLManager");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.start=function(){},r.prototype.stop=function(){this.flush()},r.prototype.flush=function(){},r.prototype.render=function(){}},{"../managers/WebGLManager":38}],44:[function(t,e){function r(t){this.gl=t,this.vertices=new Float32Array([0,0,200,0,200,200,0,200]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this.indices=new Uint16Array([0,1,2,0,3,2]),this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,128,t.DYNAMIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.upload()}r.prototype.constructor=r,r.prototype.map=function(t,e){var r=0,i=0;this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+e.width/t.width,this.uvs[3]=i,this.uvs[4]=r+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=r,this.uvs[7]=i+e.height/t.height,r=e.x,i=e.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+e.width,this.vertices[3]=i,this.vertices[4]=r+e.width,this.vertices[5]=i+e.height,this.vertices[6]=r,this.vertices[7]=i+e.height,this.upload()},r.prototype.upload=function(){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices),t.bufferSubData(t.ARRAY_BUFFER,32,this.uvs),t.bufferSubData(t.ARRAY_BUFFER,64,this.colors)},e.exports=r},{}],45:[function(t,e){var r=t("../../../math"),i=t("../../../utils"),s=t("../../../const"),n=t("./StencilMaskStack"),o=function(t,e,o,a,h,l){if(this.gl=t,this.frameBuffer=null,this.texture=null,this.size=new r.Rectangle(0,0,1,1),this.resolution=h||s.RESOLUTION,this.projectionMatrix=new r.Matrix,this.transform=null,this.frame=null,this.stencilBuffer=null,this.stencilMaskStack=new n,this.filterStack=[{renderTarget:this,filter:[],bounds:this.size}],this.scaleMode=a||s.SCALE_MODES.DEFAULT,this.root=l,!this.root){this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,a===s.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,a===s.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST);var u=i.isPowerOfTwo(e,o);u?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0)}this.resize(e,o)};o.prototype.constructor=o,e.exports=o,o.prototype.clear=function(t){var e=this.gl;t&&e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},o.prototype.attachStencilBuffer=function(){if(!this.stencilBuffer&&!this.root){var t=this.gl;this.stencilBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.size.width*this.resolution,this.size.height*this.resolution)}},o.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer);var e=this.frame||this.size;this.calculateProjection(e),this.transform&&this.projectionMatrix.append(this.transform),t.viewport(0,0,e.width*this.resolution,e.height*this.resolution)},o.prototype.calculateProjection=function(t){var e=this.projectionMatrix;e.identity(),this.root?(e.a=1/t.width*2,e.d=-1/t.height*2,e.tx=-1-t.x*e.a,e.ty=1-t.y*e.d):(e.a=1/t.width*2,e.d=1/t.height*2,e.tx=-1-t.x*e.a,e.ty=-1-t.y*e.d)},o.prototype.resize=function(t,e){if(t=0|t,e=0|e,this.size.width!==t||this.size.height!==e){if(this.size.width=t,this.size.height=e,!this.root){var r=this.gl;r.bindTexture(r.TEXTURE_2D,this.texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t*this.resolution,e*this.resolution,0,r.RGBA,r.UNSIGNED_BYTE,null),this.stencilBuffer&&(r.bindRenderbuffer(r.RENDERBUFFER,this.stencilBuffer),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t*this.resolution,e*this.resolution))}var i=this.frame||this.size;this.calculateProjection(i)}},o.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null}},{"../../../const":3,"../../../math":13,"../../../utils":57,"./StencilMaskStack":46}],46:[function(t,e){function r(){this.stencilStack=[],this.reverse=!0,this.count=0}r.prototype.constructor=r,e.exports=r},{}],47:[function(t,e){function r(t){n.call(this),this.anchor=new i.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=h.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=t||s.EMPTY}var i=t("../math"),s=t("../textures/Texture"),n=t("../display/Container"),o=t("../renderers/canvas/utils/CanvasTinter"),a=t("../utils"),h=t("../const"),l=new i.Point;r.prototype=Object.create(n.prototype),r.prototype.constructor=r,e.exports=r,Object.defineProperties(r.prototype,{width:{get:function(){return this.scale.x*this.texture._frame.width},set:function(t){this.scale.x=t/this.texture._frame.width,this._width=t}},height:{get:function(){return this.scale.y*this.texture._frame.height},set:function(t){this.scale.y=t/this.texture._frame.height,this._height=t}},texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this.cachedTint=16777215,t&&(t.baseTexture.hasLoaded?this._onTextureUpdate():t.once("update",this._onTextureUpdate.bind(this))))}}}),r.prototype._onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},r.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins.sprite),t.plugins.sprite.render(this)},r.prototype.getBounds=function(t){if(!this._currentBounds){var e,r,i,s,n=this._texture._frame.width,o=this._texture._frame.height,a=n*(1-this.anchor.x),h=n*-this.anchor.x,l=o*(1-this.anchor.y),u=o*-this.anchor.y,c=t||this.worldTransform,d=c.a,p=c.b,f=c.c,g=c.d,y=c.tx,x=c.ty;if(0===p&&0===f)0>d&&(d*=-1),0>g&&(g*=-1),e=d*h+y,r=d*a+y,i=g*u+x,s=g*l+x;else{var v=d*h+f*u+y,m=g*u+p*h+x,E=d*a+f*u+y,b=g*u+p*a+x,_=d*a+f*l+y,T=g*l+p*a+x,R=d*h+f*l+y,S=g*l+p*h+x;e=v,e=e>E?E:e,e=e>_?_:e,e=e>R?R:e,i=m,i=i>b?b:i,i=i>T?T:i,i=i>S?S:i,r=v,r=E>r?E:r,r=_>r?_:r,r=R>r?R:r,s=m,s=b>s?b:s,s=T>s?T:s,s=S>s?S:s}var A=this._bounds;A.x=e,A.width=r-e,A.y=i,A.height=s-i,this._currentBounds=A}return this._currentBounds},r.prototype.getLocalBounds=function(){return this._bounds.x=-this._texture._frame.width*this.anchor.x,this._bounds.y=-this._texture._frame.height*this.anchor.y,this._bounds.width=this._texture._frame.width,this._bounds.height=this._texture._frame.height,this._bounds},r.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,l);var e,r=this._texture._frame.width,i=this._texture._frame.height,s=-r*this.anchor.x;return l.x>s&&l.x<s+r&&(e=-i*this.anchor.y,l.y>e&&l.y<e+i)?!0:!1},r.prototype._renderCanvas=function(t){if(!(this.texture.crop.width<=0||this.texture.crop.height<=0)&&(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=t.blendModes[t.currentBlendMode]),this.texture.valid)){var e,r,i,s,n=this._texture,a=this.worldTransform,l=n.baseTexture.resolution/t.resolution;if(t.context.globalAlpha=this.worldAlpha,t.smoothProperty&&t.currentScaleMode!==n.baseTexture.scaleMode&&(t.currentScaleMode=n.baseTexture.scaleMode,t.context[t.smoothProperty]=t.currentScaleMode===h.SCALE_MODES.LINEAR),n.rotate){var u=a.a,c=a.b;a.a=-a.c,a.b=-a.d,a.c=u,a.d=c,i=n.crop.height,s=n.crop.width,e=n.trim?n.trim.y-this.anchor.y*n.trim.height:this.anchor.y*-n._frame.height,r=n.trim?n.trim.x-this.anchor.x*n.trim.width:this.anchor.x*-n._frame.width
}else i=n.crop.width,s=n.crop.height,e=n.trim?n.trim.x-this.anchor.x*n.trim.width:this.anchor.x*-n._frame.width,r=n.trim?n.trim.y-this.anchor.y*n.trim.height:this.anchor.y*-n._frame.height;t.roundPixels?(t.context.setTransform(a.a,a.b,a.c,a.d,a.tx*t.resolution|0,a.ty*t.resolution|0),e=0|e,r=0|r):t.context.setTransform(a.a,a.b,a.c,a.d,a.tx*t.resolution,a.ty*t.resolution),16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=o.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,i,s,e/l,r/l,i/l,i/l)):t.context.drawImage(n.baseTexture.source,n.crop.x,n.crop.y,i,s,e/l,r/l,i/l,s/l)}},r.prototype.destroy=function(t,e){n.prototype.destroy.call(this),this.anchor=null,t&&this._texture.destroy(e),this._texture=null,this.shader=null},r.fromFrame=function(t){var e=a.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this);return new r(e)},r.fromImage=function(t,e,i){return new r(s.fromImage(t,e,i))}},{"../const":3,"../display/Container":4,"../math":13,"../renderers/canvas/utils/CanvasTinter":28,"../textures/Texture":51,"../utils":57}],48:[function(t,e){function r(t){i.call(this,t),this.vertSize=5,this.vertByteSize=4*this.vertSize,this.size=n.SPRITE_BATCH_SIZE;var e=4*this.size*this.vertByteSize,r=6*this.size;this.vertices=new ArrayBuffer(e),this.positions=new Float32Array(this.vertices),this.colors=new Uint32Array(this.vertices),this.indices=new Uint16Array(r),this.lastIndexCount=0;for(var s=0,o=0;r>s;s+=6,o+=4)this.indices[s+0]=o+0,this.indices[s+1]=o+1,this.indices[s+2]=o+2,this.indices[s+3]=o+0,this.indices[s+4]=o+2,this.indices[s+5]=o+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.textures=[],this.blendModes=[],this.shaders=[],this.sprites=[],this.shader=null}var i=t("../../renderers/webgl/utils/ObjectRenderer"),s=(t("../../renderers/webgl/shaders/Shader"),t("../../renderers/webgl/WebGLRenderer")),n=t("../../const");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,e.exports=r,s.registerPlugin("sprite",r),r.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=this.renderer.shaderManager.defaultShader,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999},r.prototype.render=function(t){var e=t._texture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=e.baseTexture);var r=e._uvs;if(r){var i,s,n,o,a=t.anchor.x,h=t.anchor.y;if(e.trim){var l=e.trim;s=l.x-a*l.width,i=s+e.crop.width,o=l.y-h*l.height,n=o+e.crop.height}else i=e._frame.width*(1-a),s=e._frame.width*-a,n=e._frame.height*(1-h),o=e._frame.height*-h;var u=this.currentBatchSize*this.vertByteSize,c=t.worldTransform,d=c.a,p=c.b,f=c.c,g=c.d,y=c.tx,x=c.ty,v=this.colors,m=this.positions;this.renderer.roundPixels?(m[u]=d*s+f*o+y|0,m[u+1]=g*o+p*s+x|0,m[u+5]=d*i+f*o+y|0,m[u+6]=g*o+p*i+x|0,m[u+10]=d*i+f*n+y|0,m[u+11]=g*n+p*i+x|0,m[u+15]=d*s+f*n+y|0,m[u+16]=g*n+p*s+x|0):(m[u]=d*s+f*o+y,m[u+1]=g*o+p*s+x,m[u+5]=d*i+f*o+y,m[u+6]=g*o+p*i+x,m[u+10]=d*i+f*n+y,m[u+11]=g*n+p*i+x,m[u+15]=d*s+f*n+y,m[u+16]=g*n+p*s+x),m[u+2]=r.x0,m[u+3]=r.y0,m[u+7]=r.x1,m[u+8]=r.y1,m[u+12]=r.x2,m[u+13]=r.y2,m[u+17]=r.x3,m[u+18]=r.y3;var E=t.tint;v[u+4]=v[u+9]=v[u+14]=v[u+19]=(E>>16)+(65280&E)+((255&E)<<16)+(255*t.worldAlpha<<24),this.sprites[this.currentBatchSize++]=t}},r.prototype.flush=function(){if(0!==this.currentBatchSize){var t,e=this.renderer.gl;if(this.currentBatchSize>.5*this.size)e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices);else{var r=this.positions.subarray(0,this.currentBatchSize*this.vertByteSize);e.bufferSubData(e.ARRAY_BUFFER,0,r)}for(var i,s,n,o,a=0,h=0,l=null,u=this.renderer.blendModeManager.currentBlendMode,c=null,d=!1,p=!1,f=0,g=this.currentBatchSize;g>f;f++)o=this.sprites[f],i=o._texture.baseTexture,s=o.blendMode,n=o.shader||this.shader,d=u!==s,p=c!==n,(l!==i||d||p)&&(this.renderBatch(l,a,h),h=f,a=0,l=i,d&&(u=s,this.renderer.blendModeManager.setBlendMode(u)),p&&(c=n,t=c.shaders?c.shaders[e.id]:c,t||(t=c.getShader(this.renderer)),this.renderer.shaderManager.setShader(t),t.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),t.syncUniforms(),e.activeTexture(e.TEXTURE0))),a++;this.renderBatch(l,a,h),this.currentBatchSize=0}},r.prototype.renderBatch=function(t,e,r){if(0!==e){var i=this.renderer.gl;t._glTextures[i.id]?i.bindTexture(i.TEXTURE_2D,t._glTextures[i.id]):this.renderer.updateTexture(t),i.drawElements(i.TRIANGLES,6*e,i.UNSIGNED_SHORT,6*r*2),this.renderer.drawCount++}},r.prototype.start=function(){var t=this.renderer.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.vertByteSize;t.vertexAttribPointer(this.shader.attributes.aVertexPosition,2,t.FLOAT,!1,e,0),t.vertexAttribPointer(this.shader.attributes.aTextureCoord,2,t.FLOAT,!1,e,8),t.vertexAttribPointer(this.shader.attributes.aColor,4,t.UNSIGNED_BYTE,!0,e,16)},r.prototype.destroy=function(){this.renderer.gl.deleteBuffer(this.vertexBuffer),this.renderer.gl.deleteBuffer(this.indexBuffer),this.shader.destroy(),this.renderer=null,this.vertices=null,this.positions=null,this.colors=null,this.indices=null,this.vertexBuffer=null,this.indexBuffer=null,this.currentBaseTexture=null,this.drawing=!1,this.textures=null,this.blendModes=null,this.shaders=null,this.sprites=null,this.shader=null}},{"../../const":3,"../../renderers/webgl/WebGLRenderer":29,"../../renderers/webgl/shaders/Shader":41,"../../renderers/webgl/utils/ObjectRenderer":43}],49:[function(t,e){function r(t,e,r){this.uuid=i.uuid(),this.resolution=r||1,this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=e||s.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=!1,this._glTextures=[],t&&this.loadSource(t)}var i=t("../utils"),s=t("../const");r.prototype.constructor=r,e.exports=r,i.eventTarget.mixin(r.prototype),r.prototype.update=function(){this.emit("update",this)},r.prototype.loadSource=function(t){var e=this.isLoading;if(this.hasLoaded=!1,this.isLoading=!1,e&&this.source&&(this.source.onload=null,this.source.onerror=null),this.source=t,(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!t.getContext){this.isLoading=!0;var r=this;t.onload=function(){t.onload=null,t.onerror=null,r.isLoading&&(r.isLoading=!1,r._sourceLoaded(),r.emit("loaded",r))},t.onerror=function(){t.onload=null,t.onerror=null,r.isLoading&&(r.isLoading=!1,r.emit("error",r))},t.complete&&t.src&&(this.isLoading=!1,t.onload=null,t.onerror=null,t.width&&t.height?(this._sourceLoaded(),e&&this.emit("loaded",this)):e&&this.emit("error",this))}},r.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.realWidth=this.source.naturalWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=i.isPowerOfTwo(this.width,this.height),this.update()},r.prototype.destroy=function(){this.imageUrl?(delete i.BaseTextureCache[this.imageUrl],delete i.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete i.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose()},r.prototype.dispose=function(){this.emit("dispose",this)},r.prototype.updateSourceImage=function(t){this.source.src=t,this.loadSource(this.source)},r.fromImage=function(t,e,s){var n=i.BaseTextureCache[t];if(void 0===e&&0!==t.indexOf("data:")&&(e=!0),!n){var o=new Image;e&&(o.crossOrigin=""),n=new r(o,s),n.imageUrl=t,o.src=t,i.BaseTextureCache[t]=n,n.resolution=i.getResolutionOfUrl(t)}return n},r.fromCanvas=function(t,e){t._pixiId||(t._pixiId="canvas_"+i.uuid());var s=i.BaseTextureCache[t._pixiId];return s||(s=new r(t,e),i.BaseTextureCache[t._pixiId]=s),s}},{"../const":3,"../utils":57}],50:[function(t,e){function r(t,e,r,u,c){if(!t)throw new Error("Unable to create RenderTexture, you must pass a renderer into the constructor.");e=e||100,r=r||100,c=c||l.RESOLUTION;var d=new i;if(d.width=e,d.height=r,d.resolution=c,d.scaleMode=u||l.SCALE_MODES.DEFAULT,d.hasLoaded=!0,s.call(this,d,new h.Rectangle(0,0,e,r)),this.width=e,this.height=r,this.resolution=c,this.render=null,this.renderer=t,this.renderer.type===l.RENDERER_TYPE.WEBGL){var p=this.renderer.gl;this.textureBuffer=new n(p,this.width,this.height,null,this.resolution),this.baseTexture._glTextures[p.id]=this.textureBuffer.texture,this.filterManager=new o(this.renderer),this.filterManager.onContextChange(),this.filterManager.resize(e,r),this.render=this.renderWebGL,this.renderer.currentRenderer.start()}else this.render=this.renderCanvas,this.textureBuffer=new a(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this._updateUvs()}var i=t("./BaseTexture"),s=t("./Texture"),n=t("../renderers/webgl/utils/RenderTarget"),o=t("../renderers/webgl/managers/FilterManager"),a=t("../renderers/canvas/utils/CanvasBuffer"),h=t("../math"),l=t("../const"),u=new h.Matrix;r.prototype=Object.create(s.prototype),r.prototype.constructor=r,e.exports=r,r.prototype.resize=function(t,e,r){(t!==this.width||e!==this.height)&&(this.valid=t>0&&e>0,this.width=this._frame.width=this.crop.width=t,this.height=this._frame.height=this.crop.height=e,r&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.renderer.type===l.RENDERER_TYPE.WEBGL&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&(this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution),this.filterManager&&this.filterManager.resize(this.width,this.height)))},r.prototype.clear=function(){this.valid&&(this.renderer.type===l.RENDERER_TYPE.WEBGL&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},r.prototype.renderWebGL=function(t,e,r,i){if(this.valid){if(i=!!i,this.textureBuffer.transform=e,t.worldAlpha=t.alpha,i){t.worldTransform.identity(),t.currentBounds=null;var s,n,o=t.children;for(s=0,n=o.length;n>s;++s)o[s].updateTransform()}r&&this.textureBuffer.clear();var a=this.renderer.filterManager;this.renderer.filterManager=this.filterManager,this.renderer.renderDisplayObject(t,this.textureBuffer),this.renderer.filterManager=a}},r.prototype.renderCanvas=function(t,e,r,i){if(this.valid){i=!!i;var s=t.worldTransform,n=u;n.identity(),e&&n.append(e),t.worldTransform=n,t.worldAlpha=1;var o,a,h=t.children;for(o=0,a=h.length;a>o;++o)h[o].updateTransform();r&&this.textureBuffer.clear(),t.worldTransform=s;var l=this.textureBuffer.context,c=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(t,l),this.renderer.resolution=c}},r.prototype.destroy=function(){s.prototype.destroy.call(this,!0),this.textureBuffer.destroy(),this.filterManager&&this.filterManager.destroy(),this.renderer=null},r.prototype.getImage=function(){var t=new Image;return t.src=this.getBase64(),t},r.prototype.getBase64=function(){return this.getCanvas().toDataURL()},r.prototype.getCanvas=function(){if(this.renderer.type===l.RENDERER_TYPE.WEBGL){var t=this.renderer.gl,e=this.textureBuffer.width,r=this.textureBuffer.height,i=new Uint8Array(4*e*r);t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(0,0,e,r,t.RGBA,t.UNSIGNED_BYTE,i),t.bindFramebuffer(t.FRAMEBUFFER,null);var s=new a(e,r),n=s.context.getImageData(0,0,e,r);return n.data.set(i),s.context.putImageData(n,0,0),s.canvas}return this.textureBuffer.canvas}},{"../const":3,"../math":13,"../renderers/canvas/utils/CanvasBuffer":25,"../renderers/webgl/managers/FilterManager":34,"../renderers/webgl/utils/RenderTarget":45,"./BaseTexture":49,"./Texture":51}],51:[function(t,e){function r(t,e,i,s,n){this.noFrame=!1,e||(this.noFrame=!0,e=new a.Rectangle(0,0,1,1)),t instanceof r&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=i||e,this.rotate=!!n,t.hasLoaded?(this.noFrame&&(e=new a.Rectangle(0,0,t.width,t.height)),this.frame=e):t.addEventListener("loaded",this.onBaseTextureLoaded.bind(this))}var i=t("./BaseTexture"),s=t("./VideoBaseTexture"),n=t("./TextureUvs"),o=t("../utils/eventTarget"),a=t("../math"),h=t("../utils");r.prototype.constructor=r,e.exports=r,o.mixin(r.prototype),Object.defineProperties(r.prototype,{frame:{get:function(){return this._frame},set:function(t){if(this._frame=t,this.noFrame=!1,this.width=t.width,this.height=t.height,!this.trim&&!this.rotate&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=t&&t.width&&t.height&&this.baseTexture.hasLoaded,this.trim?(this.width=this.trim.width,this.height=this.trim.height,this._frame.width=this.trim.width,this._frame.height=this.trim.height):this.crop=t,this.valid&&this._updateUvs()}}}),r.prototype.update=function(){this.baseTexture.update()},r.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.frame=this.noFrame?new a.Rectangle(0,0,t.width,t.height):this._frame,this.emit("update",this)},r.prototype.destroy=function(t){t&&this.baseTexture.destroy(),this.valid=!1},r.prototype.clone=function(){return new r(this.baseTexture,this.frame,this.crop,this.trim,this.rotate)},r.prototype._updateUvs=function(){this._uvs||(this._uvs=new n),this._uvs.set(this.crop,this.baseTexture,this.rotate)},r.fromImage=function(t,e,s){var n=h.TextureCache[t];return n||(n=new r(i.fromImage(t,e,s)),h.TextureCache[t]=n),n},r.fromFrame=function(t){var e=h.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache');return e},r.fromCanvas=function(t,e){return new r(i.fromCanvas(t,e))},r.fromVideo=function(t,e){return new r(s.baseTextureFromVideo(t,e))},r.fromVideoUrl=function(t,e){return new r(s.fromUrl(t,e))},r.addTextureToCache=function(t,e){h.TextureCache[e]=t},r.removeTextureFromCache=function(t){var e=h.TextureCache[t];return delete h.TextureCache[t],delete h.BaseTextureCache[t],e},r.emptyTexture=new r(new i)},{"../math":13,"../utils":57,"../utils/eventTarget":56,"./BaseTexture":49,"./TextureUvs":52,"./VideoBaseTexture":53}],52:[function(t,e){function r(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}e.exports=r,r.prototype.set=function(t,e,r){var i=e.width,s=e.height;r?(this.x0=(t.x+t.height)/i,this.y0=t.y/s,this.x1=(t.x+t.height)/i,this.y1=(t.y+t.width)/s,this.x2=t.x/i,this.y2=(t.y+t.width)/s,this.x3=t.x/i,this.y3=t.y/s):(this.x0=t.x/i,this.y0=t.y/s,this.x1=(t.x+t.width)/i,this.y1=t.y/s,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/s,this.x3=t.x/i,this.y3=(t.y+t.height)/s)}},{}],53:[function(t,e){function r(t,e){if(!t)throw new Error("No video source element specified.");(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),s.call(this,t,e),this.autoUpdate=!1,this._onUpdate=this._onUpdate.bind(this),this._onCanPlay=this._onCanPlay.bind(this),t.complete||(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this))),this.__loaded=!1}function i(t,e){e||(e="video/"+t.substr(t.lastIndexOf(".")+1));var r=document.createElement("source");return r.src=t,r.type=e,r}var s=t("./BaseTexture"),n=t("../utils");r.prototype=Object.create(s.prototype),r.prototype.constructor=r,e.exports=r,r.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this._onUpdate),this.update())},r.prototype._onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this._onUpdate),this.autoUpdate=!0)},r.prototype._onPlayStop=function(){this.autoUpdate=!1},r.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.source.play(),this.__loaded||(this.__loaded=!0,this.emit("loaded",this)))},r.prototype.destroy=function(){this.source&&this.source._pixiId&&(n.BaseTextureCache[this.source._pixiId]=null,delete n.BaseTextureCache[this.source._pixiId],this.source._pixiId=null,delete this.source._pixiId),s.prototype.destroy.call(this)},r.fromVideo=function(t,e){t._pixiId||(t._pixiId="video_"+n.uuid());var i=n.BaseTextureCache[t._pixiId];return i||(i=new r(t,e),n.BaseTextureCache[t._pixiId]=i),i},r.fromUrl=function(t,e){var s=document.createElement("video");if(Array.isArray(t))for(var n=0;n<t.length;++n)s.appendChild(i(t.src||t,t.mime));else s.appendChild(i(t.src||t,t.mime));return s.load(),s.play(),r.fromVideo(s,e)},r.fromUrls=r.fromUrl},{"../utils":57,"./BaseTexture":49}],54:[function(t,e){function r(t,e,r){this.__isEventObject=!0,this.stopped=!1,this.stoppedImmediate=!1,this.target=t,this.type=e,this.data=r,this.timeStamp=Date.now()}r.prototype.constructor=r,e.exports=r,r.prototype.stopPropagation=function(){this.stopped=!0},r.prototype.stopImmediatePropagation=function(){this.stoppedImmediate=!0}},{}],55:[function(t,e){var r=e.exports={};r.Triangulate=function(t){var e=!0,i=t.length>>1;if(3>i)return[];for(var s=[],n=[],o=0;i>o;o++)n.push(o);o=0;for(var a=i;a>3;){var h=n[(o+0)%a],l=n[(o+1)%a],u=n[(o+2)%a],c=t[2*h],d=t[2*h+1],p=t[2*l],f=t[2*l+1],g=t[2*u],y=t[2*u+1],x=!1;if(r._convex(c,d,p,f,g,y,e)){x=!0;for(var v=0;a>v;v++){var m=n[v];if(m!==h&&m!==l&&m!==u&&r._PointInTriangle(t[2*m],t[2*m+1],c,d,p,f,g,y)){x=!1;break}}}if(x)s.push(h,l,u),n.splice((o+1)%a,1),a--,o=0;else if(o++>3*a){if(!e)return null;for(s=[],n=[],o=0;i>o;o++)n.push(o);o=0,a=i,e=!1}}return s.push(n[0],n[1],n[2]),s},r._PointInTriangle=function(t,e,r,i,s,n,o,a){var h=o-r,l=a-i,u=s-r,c=n-i,d=t-r,p=e-i,f=h*h+l*l,g=h*u+l*c,y=h*d+l*p,x=u*u+c*c,v=u*d+c*p,m=1/(f*x-g*g),E=(x*y-g*v)*m,b=(f*v-g*y)*m;return E>=0&&b>=0&&1>E+b},r._convex=function(t,e,r,i,s,n,o){return(e-i)*(s-r)+(r-t)*(n-i)>=0===o}},{}],56:[function(t,e){function r(t){t.listeners=function(t){return this._listeners=this._listeners||{},this._listeners[t]?this._listeners[t].slice():[]},t.emit=t.dispatchEvent=function(t,e){if(this._listeners=this._listeners||{},this._listeners[t]){e&&e.__isEventObject||(s.target=this,s.type=t,s.data=e,e=s);var r,i=this._listeners[t].slice(0),n=i.length,o=i[0];for(r=0;n>r;o=i[++r])if(o(e),e.stoppedImmediate)return this;return e.stopped?this:this}},t.on=t.addEventListener=function(t,e){return this._listeners=this._listeners||{},(this._listeners[t]=this._listeners[t]||[]).push(e),this},t.once=function(t,e){function r(){e.apply(i.off(t,r),arguments)}this._listeners=this._listeners||{};var i=this;return r._originalHandler=e,this.on(t,r)},t.off=t.removeEventListener=function(t,e){if(this._listeners=this._listeners||{},!this._listeners[t])return this;for(var r=this._listeners[t],i=e?r.length:0;i-->0;)(r[i]===e||r[i]._originalHandler===e)&&r.splice(i,1);return 0===r.length&&(this._listeners[t]=null),this},t.removeAllListeners=function(t){return this._listeners=this._listeners||{},this._listeners[t]?(this._listeners[t]=null,this):this}}var i=t("./EventData"),s=new i(null,null,{});e.exports={mixin:function(t){r(t)}}},{"./EventData":54}],57:[function(t,e){var r=t("../const"),i=e.exports={_uid:0,_saidHello:!1,RAFramePolyfill:t("./requestAnimationFramePolyfill"),EventData:t("./EventData"),eventTarget:t("./eventTarget"),pluginTarget:t("./pluginTarget"),PolyK:t("./PolyK"),uuid:function(){return++i._uid},hex2rgb:function(t,e){return e=e||[],e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e},hex2string:function(t){return t=t.toString(16),t="000000".substr(0,6-t.length)+t,"#"+t},rgb2hex:function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},canUseNewCanvasBlendModes:function(){if("undefined"==typeof document)return!1;var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",r=new Image;r.src=t+"AP804Oa6"+e;var i=new Image;i.src=t+"/wCKxvRF"+e;var s=document.createElement("canvas");s.width=6,s.height=1;var n=s.getContext("2d");n.globalCompositeOperation="multiply",n.drawImage(r,0,0),n.drawImage(i,2,0);var o=n.getImageData(2,0,1,1).data;return 255===o[0]&&0===o[1]&&0===o[2]},getNextPowerOfTwo:function(t){if(t>0&&0===(t&t-1))return t;for(var e=1;t>e;)e<<=1;return e},isPowerOfTwo:function(t,e){return t>0&&0===(t&t-1)&&e>0&&0===(e&e-1)},getResolutionOfUrl:function(t){var e=r.RETINA_PREFIX.exec(t);return e?parseFloat(e[1]):1},sayHello:function(t){if(!i._saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["%c %c %c Pixi.js "+r.VERSION+" - "+t+"  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];window.console.log.apply(console,e)}else window.console&&window.console.log("Pixi.js "+r.VERSION+" - "+t+" - http://www.pixijs.com/");i._saidHello=!0}},TextureCache:{},BaseTextureCache:{}}},{"../const":3,"./EventData":54,"./PolyK":55,"./eventTarget":56,"./pluginTarget":58,"./requestAnimationFramePolyfill":59}],58:[function(t,e){function r(t){t.__plugins={},t.registerPlugin=function(e,r){t.__plugins[e]=r},t.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var e in t.__plugins)this.plugins[e]=new t.__plugins[e](this)},t.prototype.destroyPlugins=function(){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;this.plugins=null}}e.exports={mixin:function(t){r(t)}}},{}],59:[function(){!function(t){for(var e=0,r=["ms","moz","webkit","o"],i=0;i<r.length&&!t.requestAnimationFrame;++i)t.requestAnimationFrame=t[r[i]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[r[i]+"CancelAnimationFrame"]||t[r[i]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(r){var i=(new Date).getTime(),s=Math.max(0,16-(i-e)),n=t.setTimeout(function(){r(i+s)},s);return e=i+s,n}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}(window)},{}],60:[function(){},{}],61:[function(t,e){e.exports={name:"perenquenjs",version:"1.0.0",homepage:"http://perenquenjs.com",description:"HTML5 Game Framework for mobile, web and desktop development.",author:"Nazari Gonzalez <nazari.nz@gmail.com> (http://www.nazariglez.com)",license:"MIT",repository:{type:"git",url:"https://github.com/Nazariglez/perenquenjs"},bin:{perenquen:"./cli/perenquen"},"private":!0,dependencies:{browserify:"^9.0.3",colors:"^1.0.3",commander:"^2.6.0",gulp:"^3.8.11","gulp-cached":"^1.0.2","gulp-jshint":"^1.9.2","gulp-rename":"^1.2.0","gulp-uglify":"^1.1.0","require-dir":"^0.1.0","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.1.0",watchify:"^2.4.0"},main:"./cli/perenquen",browser:"./build/perenquen.js"}},{}],62:[function(t,e){function r(){return this}var i=t("./const").DEFAULT_CONSTRUCTOR_NAME;r.prototype={},r.prototype.constructor=r,r.extend=function(t){var e=function(){return"function"==typeof this[i]?this[i].apply(this,arguments):this};e._super=this.prototype,e.prototype=Object.create(this.prototype);var s=function(t,r){return console.log(t),function(){var i=this._super;this._super=e._super[t];var s=r.apply(this,arguments);return this._super=i,s}};for(var n in t)if(t.hasOwnProperty(n)){var o=Object.getOwnPropertyDescriptor(t,n);"function"==typeof o.value&&(e._super[n]&&"function"==typeof e._super[n]?o.value=s(n,o.value):n===i&&(o.value=s("constructor",o.value))),Object.defineProperty(e.prototype,n,o)}return e.extend=r.extend,e.prototype.constructor=e,e},e.exports=r},{"./const":65}],63:[function(t,e){function r(t,e,r,o){this.config=n.defaultObject(s.DEFAULT_GAME_OPTIONS,r),n._saidHello=!this.config.sayHello,o=n.defaultObject(s.DEFAULT_RENDER_OPTIONS,o),this.raf=-1,this.width=t||800,this.height=e||600,this.renderer=i(this.width,this.height,o,this.config.noWebGL),this.resize(this.width,this.height),this.frameElapsedTime=0,this.frameLastTime=0,this.time=0,this.delta=0,this.isWebGL=this.renderer instanceof a,this.sceneManager=new h(this)}function i(t,e,r,i){navigator.isCocoonJS&&!r.view&&(r.view=window.document.createElement("screencanvas"));var s=new o(t,e,r,i);return window.document.body.appendChild(s.view),s}var s=t("./const"),n=t("./utils"),o=t("../../lib/pixi/src/core").autoDetectRenderer,a=t("../../lib/pixi/src/core/renderers/webgl/WebGLRenderer"),h=t("./SceneManager");r.prototype.constructor=r,r.prototype.start=function(){return this.updateTime(),this.animate(),this},r.prototype.stop=function(){return window.cancelAnimationFrame(this.raf),this},r.prototype.animate=function(){return this.raf=window.requestAnimationFrame(this.animate.bind(this)),this.updateTime(),this.renderer.render(this.sceneManager),this.sceneManager.animate(this.time,this.delta),this},r.prototype.updateTime=function(){var t=Date.now(),e=t-this.frameLastTime;return this.frameElapsedTime=e<=this.config.frameLimit?e:this.config.frameLimit,this.frameLastTime=t,this.delta=this.frameElapsedTime/1e3,this.time+=this.delta,this},r.prototype.resize=function(t,e){var r=this.renderer.view;return r.style.width=t+"px",r.style.height=e+"px",this},e.exports=r},{"../../lib/pixi/src/core":10,"../../lib/pixi/src/core/renderers/webgl/WebGLRenderer":29,"./SceneManager":64,"./const":65,"./utils":68}],64:[function(t,e){function r(t){i.call(this),this.game=t,this.scenes=[],this.currentScene=null}var i=t("../../lib/pixi/src/core/display/Container"),s=t("../display/Scene");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.addScene=function(t,e){return e&&(t.id=e),this.scenes.push(t),this},r.prototype.animate=function(t,e){return this.currentScene&&this.currentScene.animate&&this.currentScene.animate(t,e),this},r.prototype.setCurrentScene=function(t){return"string"==typeof t&&(t=this.getSceneById(t)),t.setManager(this),this.currentScene=t,this.children.length=0,this.addChild(t),this},r.prototype.createScene=function(t){var e=new s;return e.id=t?t:"id"+this.scenes.length,this.addScene(e),e},r.prototype.getSceneById=function(t){for(var e=null,r=0;r<this.scenes.length;r++)t===this.scenes[r].id&&(e=this.scenes[r]);return e},r.prototype.removeScene=function(t){"string"==typeof t&&(t=this.getSceneById(t));var e=this.scenes.indexOf(t);return-1!==e&&this.scenes.splice(e,1),this},r.prototype.removeAllScenes=function(){return this.children.length=0,this.scenes.length=0,this},e.exports=r},{"../../lib/pixi/src/core/display/Container":4,"../display/Scene":70}],65:[function(t,e){var r=t("../../lib/pixi/src/core/const");r.VERSION=t("../../package.json").version,r.PIXI_VERSION=t("../../lib/pixi/package.json").version,r.AUDIO_TYPE={UNKNOWN:0,WEBAUDIO:1,HTMLADUDIO:2},r.DEFAULT_GAME_OPTIONS={debug:!1,sayHello:!0,noWebAudio:!1,noWebGL:!1,frameLimit:35,persistantData:!0,audioExts:["ogg","mp3","wav"],pauseOnVisibilityChange:!0},r.DEFAULT_CONSTRUCTOR_NAME="_init",e.exports=r},{"../../lib/pixi/package.json":2,"../../lib/pixi/src/core/const":3,"../../package.json":61}],66:[function(t,e){var r=t("./utils").addInherits;e.exports=function(t){return r(t.utils.Pool),r(t.Graphics),r(t.Scene),r(t.Game),r(t.SceneManager),t}},{"./utils":68}],67:[function(require,module,exports){function Pool(t,e,r){return this.poolItems=[],this.objectConstructor=t||Object,this.args=e||[],this.num=r,r&&this.generateObjects(r),this}function applyFix(obj,args){for(var ev="Function('obj',",fn='"return new obj(',i=0;i<args.length;i++)ev+="'a"+i+"',",fn+="a"+i,i!==args.length-1&&(fn+=",");return fn+=')"',ev+=fn+")",eval(ev).apply(this,[obj].concat(args))}Pool.prototype.constructor=Pool,Pool.prototype.getLength=function(){return this.poolItems.length},Pool.prototype.getObject=function(){if(this.num&&this.poolItems.length<=.1*this.num)this.generateObjects(this.num);else if(this.poolItems.length<=0)return null;var t=this.poolItems.pop();return t.onPoolExit&&t.onPoolExit(this),t},Pool.prototype.putObject=function(t){return this.poolItems.unshift(t),t.onPoolEnter&&t.onPoolEnter(this),this},Pool.prototype.generateObjects=function(t){for(var e=0;t>e;e++)this.poolItems.push(this.createNewObject());return this},Pool.prototype.createNewObject=function(){var t,e=this;try{t=new(Function.prototype.bind.apply(this.objectConstructor,[null].concat(this.args)))}catch(r){t=applyFix(this.objectConstructor,this.args)}return t.returnToPool=function(){return e.putObject(this),this},t},module.exports=Pool},{}],68:[function(t,e){var r=t("../const"),i=t("../../../lib/pixi/src/core/utils"),s=t("./Pool"),n=t("../Class");i.sayHello=function(){this._saidHello||console.log("Perenquen.js v"+r.VERSION+" [http://perequenjs.com]")},i.defaultObject=function(t,e){t=t||{},e=e||{};for(var r in t)e[r]=void 0!==e[r]&&null!==e[r]?e[r]:t[r];return e},i.mixin=function(t,e){for(var r in e)t.prototype[r]=e[r]},i.addInherits=function(t){t.extend=n.extend},i.Pool=s,e.exports=i},{"../../../lib/pixi/src/core/utils":57,"../Class":62,"../const":65,"./Pool":67}],69:[function(t,e){var r=t("../../lib/pixi/src/core/graphics/Graphics"),i=t("../core/utils"),s=t("./mixin");i.mixin(r,s),e.exports=r},{"../../lib/pixi/src/core/graphics/Graphics":6,"../core/utils":68,"./mixin":71}],70:[function(t,e){function r(){i.call(this),this._backgroundColor=null,this._backgroundColorDirty=!1,this.manager=null}var i=t("../../lib/pixi/src/core/graphics/Graphics");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.setBackgroundColor=function(t){return this.backgroundColor=t,this},r.prototype.setManager=function(t){return this.manager=t,this},r.prototype.animate=function(t,e){if(this.update(t,e)){this._backgroundColorDirty&&(this.clear(),"number"==typeof this.backgroundColor&&this.beginFill(this.backgroundColor).drawRect(0,0,this.manager.game.width,this.manager.game.height).endFill(),this._backgroundColorDirty=!1);for(var r=this.children.length,i=0;r>i;i++)this.children[i].animate(t,e)}return this},r.prototype.update=function(){return!0},Object.defineProperties(r.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColorDirty=!0,this._backgroundColor=t}}}),e.exports=r},{"../../lib/pixi/src/core/graphics/Graphics":6}],71:[function(t,e){e.exports={addTo:function(t){return t&&t.addChild(this),this},update:function(){return!0},animate:function(t,e){if(this.update(t,e))for(var r=this.children.length,i=0;r>i;i++)this.children[i].animate(t,e);return this}}},{}]},{},[1])(1)});